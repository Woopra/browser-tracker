{"version":3,"file":"w.js","sources":["../node_modules/lodash-es/isUndefined.js","../node_modules/lodash-es/_freeGlobal.js","../node_modules/lodash-es/_root.js","../node_modules/lodash-es/_Symbol.js","../node_modules/lodash-es/_getRawTag.js","../node_modules/lodash-es/_objectToString.js","../node_modules/lodash-es/_baseGetTag.js","../node_modules/lodash-es/isObject.js","../node_modules/lodash-es/isFunction.js","../node_modules/lodash-es/now.js","../node_modules/lodash-es/_trimmedEndIndex.js","../node_modules/lodash-es/_baseTrim.js","../node_modules/lodash-es/isObjectLike.js","../node_modules/lodash-es/isSymbol.js","../node_modules/lodash-es/toNumber.js","../node_modules/lodash-es/debounce.js","../src/constants.js","../src/globals.js","../src/lib/events.js","../src/lib/page-lifecycle.js","../node_modules/lodash-es/isArray.js","../node_modules/lodash-es/isString.js","../node_modules/lodash-es/isFinite.js","../src/lib/utils.js","../src/lib/global-events.js","../node_modules/lodash-es/throttle.js","../node_modules/lodash-es/noop.js","../src/action.js","../node_modules/lodash-es/_baseClamp.js","../node_modules/lodash-es/_baseToString.js","../node_modules/lodash-es/_arrayMap.js","../node_modules/lodash-es/toFinite.js","../node_modules/lodash-es/toInteger.js","../node_modules/lodash-es/toString.js","../src/lib/cookies.js","../src/lib/form.js","../src/lib/script.js","../src/woopra.js","../node_modules/lodash-es/startsWith.js","../node_modules/lodash-es/endsWith.js","../src/tracker.js","../src/index.js"],"sourcesContent":["/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","export const VERSION = 11;\nexport const ENDPOINT = 'www.woopra.com/track/';\nexport const XDM_PARAM_NAME = '__woopraid';\nexport const CAMPAIGN_KEYS = [\n  'campaign',\n  'content',\n  'id',\n  'medium',\n  'source',\n  'term'\n];\nexport const SECOND_LEVEL_TLDS = [\n  'com.au',\n  'net.au',\n  'org.au',\n  'co.hu',\n  'com.ru',\n  'ac.za',\n  'net.za',\n  'com.za',\n  'co.za',\n  'co.uk',\n  'org.uk',\n  'me.uk',\n  'net.uk'\n];\nexport const RANDOM_STRING_CHARS =\n  '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\nexport const MIN_PING_INTERVAL = 6_000;\nexport const MAX_PING_INTERVAL = 60_000;\nexport const URL_ID_REGEX = new RegExp(XDM_PARAM_NAME + '=([^&#]+)');\n\nexport const LIFECYCLE_ACTION = 'action';\nexport const LIFECYCLE_PAGE = 'page';\n\nexport const SCROLL_DEPTH = 'scroll depth';\n\nexport const ACTION_PV = 'pv';\n\nexport const IDPTNC = 'idptnc';\n\nexport const TARGET_BLANK = '_blank';\n\nexport const DATA_TRACKED_ATTRIBUTE = 'data-tracked';\n\nexport const ACTION_PROPERTY_PREFIX = 'ce_';\nexport const VISIT_PROPERTY_PREFIX = 'cs_';\nexport const VISITOR_PROPERTY_PREFIX = 'cv_';\n\nexport const ENDPOINT_TRACK = 'ce';\nexport const ENDPOINT_UPDATE = 'update';\nexport const ENDPOINT_IDENTIFY = 'identify';\n\nexport const PAGE_LIFECYCLE_STATE_ACTIVE = 'active';\nexport const PAGE_LIFECYCLE_STATE_PASSIVE = 'passive';\nexport const PAGE_LIFECYCLE_STATE_HIDDEN = 'hidden';\nexport const PAGE_LIFECYCLE_STATE_FROZEN = 'frozen';\nexport const PAGE_LIFECYCLE_STATE_TERMINATED = 'terminated';\n\nexport const EVENT_BEFOREUNLOAD = 'beforeunload';\nexport const EVENT_BLUR = 'blur';\nexport const EVENT_CLICK = 'click';\nexport const EVENT_DOWNLOAD = 'download';\nexport const EVENT_FOCUS = 'focus';\nexport const EVENT_FREEZE = 'freeze';\nexport const EVENT_LINK_CLICK = 'link';\nexport const EVENT_MOUSEDOWN = 'mousedown';\nexport const EVENT_MOUSEMOVE = 'mousemove';\nexport const EVENT_OUTGOING = 'outgoing';\nexport const EVENT_PAGEHIDE = 'pagehide';\nexport const EVENT_PAGESHOW = 'pageshow';\nexport const EVENT_RESUME = 'resume';\nexport const EVENT_SCROLL = 'scroll';\nexport const EVENT_STATECHANGE = 'statechange';\nexport const EVENT_UNLOAD = 'unload';\nexport const EVENT_VISIBILITYCHANGE = 'visibilitychange';\n\nexport const KEY_APP = 'app';\nexport const KEY_AUTO_DECORATE = 'auto_decorate';\nexport const KEY_BEACONS = 'beacons';\nexport const KEY_CAMPAIGN_ONCE = 'campaign_once';\nexport const KEY_CLICK_PAUSE = 'click_pause';\nexport const KEY_CLICK_TRACKING = 'click_tracking';\nexport const KEY_CONTEXT = 'context';\nexport const KEY_COOKIE_DOMAIN = 'cookie_domain';\nexport const KEY_COOKIE_EXPIRE = 'cookie_expire';\nexport const KEY_COOKIE_NAME = 'cookie_name';\nexport const KEY_COOKIE_PATH = 'cookie_path';\nexport const KEY_CROSS_DOMAIN = 'cross_domain';\nexport const KEY_DOMAIN = 'domain';\nexport const KEY_DOWNLOAD_EXTENSIONS = 'download_extensions';\nexport const KEY_DOWNLOAD_PAUSE = 'download_pause';\nexport const KEY_DOWNLOAD_TRACKING = 'download_tracking';\nexport const KEY_FORM_PAUSE = 'form_pause';\nexport const KEY_HIDE_CAMPAIGN = 'hide_campaign';\nexport const KEY_HIDE_XDM_DATA = 'hide_xdm_data';\nexport const KEY_IDLE_THRESHOLD = 'idle_threshold';\nexport const KEY_IDLE_TIMEOUT = 'idle_timeout';\nexport const KEY_IGNORE_QUERY_URL = 'ignore_query_url';\nexport const KEY_IP = 'ip';\nexport const KEY_MAP_QUERY_PARAMS = 'map_query_params';\nexport const KEY_OUTGOING_IGNORE_SUBDOMAIN = 'outgoing_ignore_subdomain';\nexport const KEY_OUTGOING_PAUSE = 'outgoing_pause';\nexport const KEY_OUTGOING_TRACKING = 'outgoing_tracking';\nexport const KEY_PERSONALIZATION = 'personalization';\nexport const KEY_PING = 'ping';\nexport const KEY_PING_INTERVAL = 'ping_interval';\nexport const KEY_PROTOCOL = 'protocol';\nexport const KEY_SAVE_URL_HASH = 'save_url_hash';\nexport const KEY_THIRD_PARTY = 'third_party';\nexport const KEY_USE_COOKIES = 'use_cookies';\n\nexport const META_CANCELLED = 'cancelled';\nexport const META_DIRTY = 'dirty';\nexport const META_DURATION = 'duration';\nexport const META_EXPIRED = 'expired';\nexport const META_LEAVE = 'leave';\nexport const META_RETRACK = 'retrack';\nexport const META_SENT = 'sent';\nexport const META_TIMESTAMP = 'timestamp';\n\nexport const ACTION_PROPERTY_ALIASES = [\n  [IDPTNC, IDPTNC],\n  ['$duration', 'duration'],\n  ['$domain', 'domain'],\n  ['$app', 'app'],\n  ['$timestamp', 'timestamp'],\n  ['$action', 'event']\n];\n\nexport const DEFAULT_DOWNLOAD_EXTENSIONS = [\n  'avi',\n  'css',\n  'dmg',\n  'doc',\n  'eps',\n  'exe',\n  'js',\n  'm4v',\n  'mov',\n  'mp3',\n  'mp4',\n  'msi',\n  'pdf',\n  'ppt',\n  'rar',\n  'svg',\n  'txt',\n  'vsd',\n  'vxd',\n  'wma',\n  'wmv',\n  'xls',\n  'xlsx',\n  'zip'\n];\n\nexport const ELEMENT_MATCHER_LINK = ['a'];\n\nexport const ELEMENT_MATCHER_CLICK = [\n  'a',\n  'button',\n  { tagName: 'input', type: 'button' },\n  { tagName: 'input', type: 'submit' }\n];\n","import {\n  KEY_AUTO_DECORATE,\n  KEY_DOWNLOAD_TRACKING,\n  KEY_OUTGOING_IGNORE_SUBDOMAIN,\n  KEY_OUTGOING_TRACKING\n} from './constants';\n\nexport default {\n  [KEY_AUTO_DECORATE]: undefined,\n  [KEY_DOWNLOAD_TRACKING]: false,\n  [KEY_OUTGOING_IGNORE_SUBDOMAIN]: true,\n  [KEY_OUTGOING_TRACKING]: false\n};\n","const handlers = {};\n\nexport function removeHandler(id, instance) {\n  handlers[id][instance] = null;\n}\n\nexport function addEventListener(element, type, callback) {\n  if (element?.addEventListener) {\n    element.addEventListener(type, callback);\n  }\n}\n\nexport function on(parent, event, callback) {\n  const id = parent.instanceName;\n\n  if (!handlers[event]) {\n    handlers[event] = {};\n  }\n  handlers[event][id] = parent;\n\n  if (parent.__l) {\n    if (!parent.__l[event]) {\n      parent.__l[event] = [];\n    }\n    parent.__l[event].push(callback);\n  }\n}\n\nexport function fire(event) {\n  let handler;\n  const _event = handlers[event];\n  let _l;\n\n  if (_event) {\n    for (let id in _event) {\n      if (_event.hasOwnProperty(id)) {\n        handler = _event[id];\n        _l = handler && handler.__l;\n        if (_l && _l[event]) {\n          for (let i = 0; i < _l[event].length; i++) {\n            _l[event][i].apply(this, Array.prototype.slice.call(arguments, 1));\n          }\n        }\n      }\n    }\n  }\n}\n","/*\n Copyright 2018 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n     http://www.apache.org/licenses/LICENSE-2.0\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n*/\n\n/**\n * Original source: https://github.com/GoogleChromeLabs/page-lifecycle\n * MODIFICATIONS:\n * - inline imports\n * - always use shims\n * - use constants in place of string literals\n */\n\nimport {\n  EVENT_BEFOREUNLOAD,\n  EVENT_BLUR,\n  EVENT_FOCUS,\n  EVENT_FREEZE,\n  EVENT_PAGEHIDE,\n  EVENT_PAGESHOW,\n  EVENT_RESUME,\n  EVENT_UNLOAD,\n  EVENT_VISIBILITYCHANGE,\n  PAGE_LIFECYCLE_STATE_ACTIVE,\n  PAGE_LIFECYCLE_STATE_FROZEN,\n  PAGE_LIFECYCLE_STATE_HIDDEN,\n  PAGE_LIFECYCLE_STATE_PASSIVE,\n  PAGE_LIFECYCLE_STATE_TERMINATED\n} from '../constants';\n\nclass EventTargetShim {\n  /**\n   * Creates the event registry.\n   */\n  constructor() {\n    this._registry = {};\n  }\n\n  /**\n   * @param {string} type\n   * @param {EventListener|function(!Event):(boolean|undefined)} listener\n   * @param {(boolean|!AddEventListenerOptions)=} opts\n   * @return {undefined}\n   * @see https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener\n   */\n  addEventListener(type, listener, opts = false) {\n    this._getRegistry(type).push(listener);\n  }\n\n  /**\n   * @param {string} type\n   * @param {EventListener|function(!Event):(boolean|undefined)} listener\n   * @param {(boolean|!EventListenerOptions)=} opts\n   * @return {undefined}\n   * @see https://dom.spec.whatwg.org/#dom-eventtarget-removeeventlistener\n   */\n  removeEventListener(type, listener, opts = false) {\n    const typeRegistry = this._getRegistry(type);\n    const handlerIndex = typeRegistry.indexOf(listener);\n    if (handlerIndex > -1) {\n      typeRegistry.splice(handlerIndex, 1);\n    }\n  }\n\n  /**\n   * @param {!Event|!EventShim} evt\n   * @return {boolean}\n   * @see https://dom.spec.whatwg.org/#dom-eventtarget-dispatchevent\n   */\n  dispatchEvent(evt) {\n    // Set the target then freeze the event object to prevent modification.\n    evt.target = this;\n    Object.freeze(evt);\n\n    this._getRegistry(evt.type).forEach((listener) => listener(evt));\n    return true;\n  }\n\n  /**\n   * Returns an array of handlers associated with the passed event type.\n   * If no handlers have been registered, an empty array is returned.\n   * @private\n   * @param {string} type The event type.\n   * @return {!Array} An array of handler functions.\n   */\n  _getRegistry(type) {\n    return (this._registry[type] = this._registry[type] || []);\n  }\n}\n\nclass StateChangeEvent {\n  constructor(type, initDict) {\n    this.type = type;\n    this.newState = initDict.newState;\n    this.oldState = initDict.oldState;\n    this.originalEvent = initDict.originalEvent;\n  }\n}\n\n// Detect Safari to work around Safari-specific bugs.\nconst IS_SAFARI = typeof safari === 'object' && safari.pushNotification;\n\nconst SUPPORTS_PAGE_TRANSITION_EVENTS = 'onpageshow' in self;\n\nconst EVENTS = [\n  EVENT_FOCUS,\n  EVENT_BLUR,\n  EVENT_VISIBILITYCHANGE,\n  EVENT_FREEZE,\n  EVENT_RESUME,\n  EVENT_PAGESHOW,\n  // IE9-10 do not support the pagehide event, so we fall back to unload\n  // Note: unload *MUST ONLY* be added conditionally, otherwise it will\n  // prevent page navigation caching (a.k.a bfcache).\n  SUPPORTS_PAGE_TRANSITION_EVENTS ? EVENT_PAGEHIDE : EVENT_UNLOAD\n];\n\n/**\n * @param {!Event} evt\n * @return {string}\n */\nconst onbeforeunload = (evt) => {\n  evt.preventDefault();\n  return (evt.returnValue = 'Are you sure?');\n};\n\n/**\n * Converts an array of states into an object where the state is the key\n * and the value is the index.\n * @param {!Array<string>} arr\n * @return {!Object}\n */\nconst toIndexedObject = (arr) =>\n  arr.reduce((acc, val, idx) => {\n    acc[val] = idx;\n    return acc;\n  }, {});\n\n/**\n * @type {!Array<!Object>}\n */\nconst LEGAL_STATE_TRANSITIONS = [\n  // The normal unload process (bfcache process is addressed above).\n  [\n    PAGE_LIFECYCLE_STATE_ACTIVE,\n    PAGE_LIFECYCLE_STATE_PASSIVE,\n    PAGE_LIFECYCLE_STATE_HIDDEN,\n    PAGE_LIFECYCLE_STATE_TERMINATED\n  ],\n\n  // An active page transitioning to frozen,\n  // or an unloading page going into the bfcache.\n  [\n    PAGE_LIFECYCLE_STATE_ACTIVE,\n    PAGE_LIFECYCLE_STATE_PASSIVE,\n    PAGE_LIFECYCLE_STATE_HIDDEN,\n    PAGE_LIFECYCLE_STATE_FROZEN\n  ],\n\n  // A hidden page transitioning back to active.\n  [\n    PAGE_LIFECYCLE_STATE_HIDDEN,\n    PAGE_LIFECYCLE_STATE_PASSIVE,\n    PAGE_LIFECYCLE_STATE_ACTIVE\n  ],\n\n  // A frozen page being resumed\n  [PAGE_LIFECYCLE_STATE_FROZEN, PAGE_LIFECYCLE_STATE_HIDDEN],\n\n  // A frozen (bfcached) page navigated back to\n  // Note: [FROZEN, HIDDEN] can happen here, but it's already covered above.\n  [PAGE_LIFECYCLE_STATE_FROZEN, PAGE_LIFECYCLE_STATE_ACTIVE],\n  [PAGE_LIFECYCLE_STATE_FROZEN, PAGE_LIFECYCLE_STATE_PASSIVE]\n].map(toIndexedObject);\n\n/**\n * Accepts a current state and a future state and returns an array of legal\n * state transition paths. This is needed to normalize behavior across browsers\n * since some browsers do not fire events in certain cases and thus skip\n * states.\n * @param {string} oldState\n * @param {string} newState\n * @return {!Array<string>}\n */\nconst getLegalStateTransitionPath = (oldState, newState) => {\n  // We're intentionally not using for...of here so when we transpile to ES5\n  // we don't need to include the Symbol polyfills.\n  for (let order, i = 0; (order = LEGAL_STATE_TRANSITIONS[i]); ++i) {\n    const oldIndex = order[oldState];\n    const newIndex = order[newState];\n\n    if (oldIndex >= 0 && newIndex >= 0 && newIndex > oldIndex) {\n      // Differences greater than one should be reported\n      // because it means a state was skipped.\n      return Object.keys(order).slice(oldIndex, newIndex + 1);\n    }\n  }\n  return [];\n  // TODO(philipwalton): it shouldn't be possible to get here, but\n  // consider some kind of warning or call to action if it happens.\n  // console.warn(`Invalid state change detected: ${oldState} > ${newState}`);\n};\n\n/**\n * Returns the current state based on the document's visibility and\n * in input focus states. Note this method is only used to determine\n * active vs passive vs hidden states, as other states require listening\n * for events.\n * @return {string}\n */\nconst getCurrentState = () => {\n  if (document.visibilityState === PAGE_LIFECYCLE_STATE_HIDDEN) {\n    return PAGE_LIFECYCLE_STATE_HIDDEN;\n  }\n  if (document.hasFocus()) {\n    return PAGE_LIFECYCLE_STATE_ACTIVE;\n  }\n  return PAGE_LIFECYCLE_STATE_PASSIVE;\n};\n\n/**\n * Class definition for the exported, singleton lifecycle instance.\n */\nclass PageLifecycle extends EventTargetShim {\n  /**\n   * Initializes state, state history, and adds event listeners to monitor\n   * state changes.\n   */\n  constructor() {\n    super();\n\n    const state = getCurrentState();\n\n    this._state = state;\n    this._unsavedChanges = [];\n\n    // Bind the callback and add event listeners.\n    this._handleEvents = this._handleEvents.bind(this);\n\n    // Add capturing events on window so they run immediately.\n    EVENTS.forEach((evt) => addEventListener(evt, this._handleEvents, true));\n\n    // Safari does not reliably fire the `pagehide` or `visibilitychange`\n    // events when closing a tab, so we have to use `beforeunload` with a\n    // timeout to check whether the default action was prevented.\n    // - https://bugs.webkit.org/show_bug.cgi?id=151610\n    // - https://bugs.webkit.org/show_bug.cgi?id=151234\n    // NOTE: we only add this to Safari because adding it to Firefox would\n    // prevent the page from being eligible for bfcache.\n    if (IS_SAFARI) {\n      addEventListener(EVENT_BEFOREUNLOAD, (evt) => {\n        this._safariBeforeUnloadTimeout = setTimeout(() => {\n          if (!(evt.defaultPrevented || evt.returnValue.length > 0)) {\n            this._dispatchChangesIfNeeded(evt, PAGE_LIFECYCLE_STATE_HIDDEN);\n          }\n        }, 0);\n      });\n    }\n  }\n\n  /**\n   * @return {string}\n   */\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * Returns the value of document.wasDiscarded. This is arguably unnecessary\n   * but I think there's value in having the entire API in one place and\n   * consistent across browsers.\n   * @return {boolean}\n   */\n  get pageWasDiscarded() {\n    return document.wasDiscarded || false;\n  }\n\n  /**\n   * @param {Symbol|Object} id A unique symbol or object identifying the\n   *.    pending state. This ID is required when removing the state later.\n   */\n  addUnsavedChanges(id) {\n    // Don't add duplicate state. Note: ideally this would be a set, but for\n    // better browser compatibility we're using an array.\n    if (!this._unsavedChanges.indexOf(id) > -1) {\n      // If this is the first state being added,\n      // also add a beforeunload listener.\n      if (this._unsavedChanges.length === 0) {\n        addEventListener(EVENT_BEFOREUNLOAD, onbeforeunload);\n      }\n      this._unsavedChanges.push(id);\n    }\n  }\n\n  /**\n   * @param {Symbol|Object} id A unique symbol or object identifying the\n   *.    pending state. This ID is required when removing the state later.\n   */\n  removeUnsavedChanges(id) {\n    const idIndex = this._unsavedChanges.indexOf(id);\n\n    if (idIndex > -1) {\n      this._unsavedChanges.splice(idIndex, 1);\n\n      // If there's no more pending state, remove the event listener.\n      if (this._unsavedChanges.length === 0) {\n        removeEventListener(EVENT_BEFOREUNLOAD, onbeforeunload);\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {!Event} originalEvent\n   * @param {string} newState\n   */\n  _dispatchChangesIfNeeded(originalEvent, newState) {\n    if (newState !== this._state) {\n      const oldState = this._state;\n      const path = getLegalStateTransitionPath(oldState, newState);\n\n      for (let i = 0; i < path.length - 1; ++i) {\n        const oldState = path[i];\n        const newState = path[i + 1];\n\n        this._state = newState;\n        this.dispatchEvent(\n          new StateChangeEvent('statechange', {\n            oldState,\n            newState,\n            originalEvent\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {!Event} evt\n   */\n  _handleEvents(evt) {\n    if (IS_SAFARI) {\n      clearTimeout(this._safariBeforeUnloadTimeout);\n    }\n\n    switch (evt.type) {\n      case EVENT_PAGESHOW:\n      case EVENT_RESUME:\n        this._dispatchChangesIfNeeded(evt, getCurrentState());\n        break;\n      case EVENT_FOCUS:\n        this._dispatchChangesIfNeeded(evt, PAGE_LIFECYCLE_STATE_ACTIVE);\n        break;\n      case EVENT_BLUR:\n        // The `blur` event can fire while the page is being unloaded, so we\n        // only need to update the state if the current state is \"active\".\n        if (this._state === PAGE_LIFECYCLE_STATE_ACTIVE) {\n          this._dispatchChangesIfNeeded(evt, getCurrentState());\n        }\n        break;\n      case EVENT_PAGEHIDE:\n      case EVENT_UNLOAD:\n        this._dispatchChangesIfNeeded(\n          evt,\n          evt.persisted\n            ? PAGE_LIFECYCLE_STATE_FROZEN\n            : PAGE_LIFECYCLE_STATE_TERMINATED\n        );\n        break;\n      case EVENT_VISIBILITYCHANGE:\n        // The document's `visibilityState` will change to hidden  as the page\n        // is being unloaded, but in such cases the lifecycle state shouldn't\n        // change.\n        if (\n          this._state !== PAGE_LIFECYCLE_STATE_FROZEN &&\n          this._state !== PAGE_LIFECYCLE_STATE_TERMINATED\n        ) {\n          this._dispatchChangesIfNeeded(evt, getCurrentState());\n        }\n        break;\n      case EVENT_FREEZE:\n        this._dispatchChangesIfNeeded(evt, PAGE_LIFECYCLE_STATE_FROZEN);\n        break;\n    }\n  }\n}\n\nexport default new PageLifecycle();\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import baseGetTag from './_baseGetTag.js';\nimport isArray from './isArray.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nexport default isString;\n","import root from './_root.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite;\n\n/**\n * Checks if `value` is a finite primitive number.\n *\n * **Note:** This method is based on\n * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n * @example\n *\n * _.isFinite(3);\n * // => true\n *\n * _.isFinite(Number.MIN_VALUE);\n * // => true\n *\n * _.isFinite(Infinity);\n * // => false\n *\n * _.isFinite('3');\n * // => false\n */\nfunction isFinite(value) {\n  return typeof value == 'number' && nativeIsFinite(value);\n}\n\nexport default isFinite;\n","import { isFinite, isFunction, isString, isUndefined } from 'lodash-es';\nimport { RANDOM_STRING_CHARS } from '../constants';\n\n/**\n * Generates a random 12 character string\n *\n * @return {String} Returns a random 12 character string\n */\nexport function randomString() {\n  let s = '';\n\n  for (let i = 0; i < 12; i++) {\n    const rnum = Math.floor(Math.random() * RANDOM_STRING_CHARS.length);\n    s += RANDOM_STRING_CHARS.substring(rnum, rnum + 1);\n  }\n\n  return s;\n}\n\nexport function isLeftClick(evt = window.event) {\n  const button =\n    (!isUndefined(evt.which) && evt.which === 1) ||\n    (!isUndefined(evt.button) && evt.button === 0);\n  return button && !evt.metaKey && !evt.altKey && !evt.ctrlKey && !evt.shiftKey;\n}\n\n/**\n * Helper to either query an element by id, or return element if passed\n * through options\n *\n * Supports searching by ids and classnames (or querySelector if browser supported)\n */\nexport function getElement(selector, options) {\n  const _options = isString(selector) ? options || {} : selector || {};\n\n  if (_options.el) {\n    return _options.el;\n  } else if (isString(selector)) {\n    if (document.querySelectorAll) {\n      return document.querySelectorAll(selector);\n    } else if (selector[0] === '#') {\n      return document.getElementById(selector.substr(1));\n    } else if (selector[0] === '.') {\n      return document.getElementsByClassName(selector.substr(1));\n    }\n  }\n}\n\nexport function prefixObjectKeys(object, prefix, blacklist) {\n  const obj = {};\n\n  if (isUndefined(object)) return obj;\n\n  for (let key in object) {\n    if (object.hasOwnProperty(key)) {\n      const value = object[key];\n\n      let isBlacklisted = false;\n\n      for (let i = 0; i < blacklist.length; i++) {\n        if (blacklist[i][0] === key) {\n          isBlacklisted = true;\n          break;\n        }\n      }\n\n      if (\n        !isBlacklisted &&\n        value !== 'undefined' &&\n        value !== 'null' &&\n        !isUndefined(value)\n      ) {\n        obj[`${prefix}${key}`] = value;\n      }\n    }\n  }\n\n  return obj;\n}\n\nexport function getScrollDepth() {\n  const scrollHeight = document.body.scrollHeight;\n\n  const scrollDepth =\n    ((window.scrollY || 0) + window.innerHeight) / scrollHeight;\n\n  return Math.max(0, Math.min(1, isFinite(scrollDepth) ? scrollDepth : 0));\n}\n\nexport function callCallback(callback, action) {\n  try {\n    callback();\n  } catch (e) {\n    console.error(`Error in Woopra ${action} callback`); // eslint-disable-line no-console\n    console.error(e.stack); // eslint-disable-line no-console\n  }\n}\n\nfunction matchesElement(element, matcher) {\n  const elementTagName = element.tagName.toLowerCase();\n\n  for (let i = 0; i < matcher.length; i++) {\n    const match = matcher[i];\n    const tagName = (match?.tagName ?? match).toLowerCase();\n\n    if (elementTagName !== tagName) continue;\n\n    if (isString(match) || match?.type === element.type) return true;\n  }\n\n  return false;\n}\n\nexport function findParentElement(element, matcher) {\n  let elem = element;\n\n  while (!isUndefined(elem) && elem !== null) {\n    if (elem.tagName && matchesElement(elem, matcher)) break;\n\n    elem = elem.parentNode;\n  }\n\n  return elem;\n}\n\nexport function hasBeaconSupport() {\n  return isFunction(navigator.sendBeacon);\n}\n","import { isUndefined, throttle } from 'lodash-es';\nimport {\n  DATA_TRACKED_ATTRIBUTE,\n  ELEMENT_MATCHER_LINK,\n  EVENT_CLICK,\n  EVENT_LINK_CLICK,\n  EVENT_MOUSEDOWN,\n  EVENT_MOUSEMOVE,\n  EVENT_SCROLL,\n  EVENT_STATECHANGE,\n  KEY_AUTO_DECORATE,\n  KEY_DOWNLOAD_TRACKING,\n  KEY_OUTGOING_TRACKING\n} from '../constants';\nimport globals from '../globals';\nimport { addEventListener, fire } from './events';\nimport PageLifecycle from './page-lifecycle';\nimport { findParentElement, isLeftClick } from './utils';\n\nfunction onClick(e) {\n  let elem = e.srcElement || e.target;\n\n  if (isLeftClick(e)) {\n    fire(EVENT_CLICK, e, elem);\n  }\n\n  if (globals[KEY_DOWNLOAD_TRACKING] || globals[KEY_OUTGOING_TRACKING]) {\n    elem = findParentElement(e.srcElement || e.target, ELEMENT_MATCHER_LINK);\n\n    if (\n      !isUndefined(elem) &&\n      elem !== null &&\n      !elem.getAttribute(DATA_TRACKED_ATTRIBUTE)\n    ) {\n      fire(EVENT_LINK_CLICK, e, elem);\n    }\n  }\n}\n\nfunction onMouseDown(e) {\n  let elem;\n\n  fire(EVENT_MOUSEMOVE, e, Date.now());\n\n  if (globals[KEY_AUTO_DECORATE]) {\n    elem = findParentElement(e.srcElement || e.target, ELEMENT_MATCHER_LINK);\n\n    if (!isUndefined(elem) && elem !== null) {\n      fire(KEY_AUTO_DECORATE, elem);\n    }\n  }\n}\n\nfunction onMouseMove(e) {\n  fire(EVENT_MOUSEMOVE, e, Date.now());\n}\n\nconst onScroll = throttle(function onScroll(e) {\n  fire(EVENT_SCROLL, e);\n}, 500);\n\nfunction onPageStateChange(e) {\n  fire(EVENT_STATECHANGE, e);\n}\n\nconst CAPTURE = { capture: true };\nconst CAPTURE_PASSIVE = { capture: true, passive: true };\n\n// attaches events\n// needs to be handled here, instead of in a tracking instance because\n// these events should only be fired once on a page\nexport default function attachGlobalEvents() {\n  addEventListener(document, EVENT_CLICK, onClick, CAPTURE);\n  addEventListener(document, EVENT_MOUSEDOWN, onMouseDown, CAPTURE);\n  addEventListener(document, EVENT_MOUSEMOVE, onMouseMove, CAPTURE_PASSIVE);\n  addEventListener(window, EVENT_SCROLL, onScroll, CAPTURE_PASSIVE);\n\n  PageLifecycle.addEventListener(EVENT_STATECHANGE, onPageStateChange);\n}\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","export default class WoopraAction {\n  constructor(woopra, id, params, meta) {\n    this.woopra = woopra;\n    this.id = id;\n    this.params = params;\n    this.meta = meta;\n  }\n\n  update(options = {}, lastArg) {\n    if (options.event && options.event !== this.params.event) {\n      this.params.event = options.event;\n    }\n\n    this.woopra.update(\n      this.id,\n      { ...options, $action: this.params.event },\n      lastArg\n    );\n  }\n\n  cancel() {\n    this.woopra.cancelAction(this.id);\n  }\n}\n","/**\n * The base implementation of `_.clamp` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n */\nfunction baseClamp(number, lower, upper) {\n  if (number === number) {\n    if (upper !== undefined) {\n      number = number <= upper ? number : upper;\n    }\n    if (lower !== undefined) {\n      number = number >= lower ? number : lower;\n    }\n  }\n  return number;\n}\n\nexport default baseClamp;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","/*\\\n|*|\n|*|  :: cookies.js ::\n|*|\n|*|  A complete cookies reader/writer framework with full unicode support.\n|*|\n|*|  Revision #1 - September 4, 2014\n|*|\n|*|  https://developer.mozilla.org/en-US/docs/Web/API/document.cookie\n|*|  https://developer.mozilla.org/User:fusionchess\n|*|\n|*|  This framework is released under the GNU Public License, version 3 or later.\n|*|  http://www.gnu.org/licenses/gpl-3.0-standalone.html\n|*|\n|*|  Syntaxes:\n|*|\n|*|  * docCookies.setItem(name, value[, end[, path[, domain[, secure]]]])\n|*|  * docCookies.getItem(name)\n|*|  * docCookies.removeItem(name[, path[, domain]])\n|*|  * docCookies.hasItem(name)\n|*|  * docCookies.keys()\n|*|\n\\*/\n\nexport function getItem(sKey) {\n  if (!sKey) {\n    return null;\n  }\n  return (\n    decodeURIComponent(\n      document.cookie.replace(\n        new RegExp(\n          '(?:(?:^|.*;)\\\\s*' +\n            encodeURIComponent(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') +\n            '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'\n        ),\n        '$1'\n      )\n    ) || null\n  );\n}\n\nexport function setItem(sKey, sValue, vEnd, sPath, sDomain, bSecure) {\n  if (!sKey || /^(?:expires|max\\-age|path|domain|secure)$/i.test(sKey)) {\n    return false;\n  }\n  let sExpires = '';\n  if (vEnd) {\n    switch (vEnd.constructor) {\n      case Number:\n        sExpires =\n          vEnd === Infinity\n            ? '; expires=Fri, 31 Dec 9999 23:59:59 GMT'\n            : '; max-age=' + vEnd;\n        break;\n      case String:\n        sExpires = '; expires=' + vEnd;\n        break;\n      case Date:\n        sExpires = '; expires=' + vEnd.toUTCString();\n        break;\n    }\n  }\n  document.cookie =\n    encodeURIComponent(sKey) +\n    '=' +\n    encodeURIComponent(sValue) +\n    sExpires +\n    (sDomain ? '; domain=' + sDomain : '') +\n    (sPath ? '; path=' + sPath : '') +\n    (bSecure ? '; secure' : '');\n  return true;\n}\n\nexport function removeItem(sKey, sPath, sDomain) {\n  if (!hasItem(sKey)) {\n    return false;\n  }\n  document.cookie =\n    encodeURIComponent(sKey) +\n    '=; expires=Thu, 01 Jan 1970 00:00:00 GMT' +\n    (sDomain ? '; domain=' + sDomain : '') +\n    (sPath ? '; path=' + sPath : '');\n  return true;\n}\n\nexport function hasItem(sKey) {\n  if (!sKey) {\n    return false;\n  }\n  return new RegExp(\n    '(?:^|;\\\\s*)' +\n      encodeURIComponent(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') +\n      '\\\\s*\\\\='\n  ).test(document.cookie);\n}\n\nexport function keys() {\n  const aKeys = document.cookie\n    .replace(/((?:^|\\s*;)[^\\=]+)(?=;|$)|^\\s*|\\s*(?:\\=[^;]*)?(?:\\1|$)/g, '')\n    .split(/\\s*(?:\\=[^;]*)?;\\s*/);\n  for (let nLen = aKeys.length, nIdx = 0; nIdx < nLen; nIdx++) {\n    aKeys[nIdx] = decodeURIComponent(aKeys[nIdx]);\n  }\n  return aKeys;\n}\n","const TYPE_BUTTON = 'button';\nconst TYPE_SUBMIT = 'submit';\nconst TYPE_RESET = 'reset';\n\n// https://code.google.com/p/form-serialize/\n// modified to return an object\nexport function serializeForm(form, options = {}) {\n  if (!form || form.nodeName !== 'FORM') {\n    return;\n  }\n\n  const exclude = options.exclude || [];\n  const data = {};\n\n  for (let i = form.elements.length - 1; i >= 0; i = i - 1) {\n    if (\n      form.elements[i].name === '' ||\n      exclude.indexOf(form.elements[i].name) > -1\n    ) {\n      continue;\n    }\n    switch (form.elements[i].nodeName) {\n      case 'INPUT':\n        switch (form.elements[i].type) {\n          case 'text':\n          case 'hidden':\n          case TYPE_BUTTON:\n          case TYPE_RESET:\n          case TYPE_SUBMIT:\n            data[form.elements[i].name] = form.elements[i].value;\n            break;\n          case 'checkbox':\n          case 'radio':\n            if (form.elements[i].checked) {\n              data[form.elements[i].name] = form.elements[i].value;\n            }\n            break;\n          case 'file':\n            break;\n        }\n        break;\n      case 'TEXTAREA':\n        data[form.elements[i].name] = form.elements[i].value;\n        break;\n      case 'SELECT':\n        switch (form.elements[i].type) {\n          case 'select-one':\n            data[form.elements[i].name] = form.elements[i].value;\n            break;\n          case 'select-multiple':\n            for (\n              let j = form.elements[i].options.length - 1;\n              j >= 0;\n              j = j - 1\n            ) {\n              if (form.elements[i].options[j].selected) {\n                data[form.elements[i].name] = form.elements[i].options[j].value;\n              }\n            }\n            break;\n        }\n        break;\n      case 'BUTTON':\n        switch (form.elements[i].type) {\n          case TYPE_RESET:\n          case TYPE_SUBMIT:\n          case TYPE_BUTTON:\n            data[form.elements[i].name] = form.elements[i].value;\n            break;\n        }\n        break;\n    }\n  }\n  return data;\n}\n","import { isUndefined, noop } from 'lodash-es';\n\nexport function removeScript(script) {\n  if (script && script.parentNode) {\n    script.parentNode.removeChild(script);\n  }\n}\n\nconst statusIsSuccessful = (readyState) =>\n  readyState === 4 || readyState === 'complete' || readyState === 'loaded';\n\nexport function loadScript(url, callback = noop, errorCallback = noop) {\n  const script = document.createElement('script');\n\n  script.type = 'text/javascript';\n  script.async = true;\n\n  if (!isUndefined(script.onreadystatechange)) {\n    script.onreadystatechange = function onreadystatechange() {\n      if (statusIsSuccessful(this.readyState)) {\n        callback();\n        removeScript(script);\n      }\n    };\n  } else {\n    script.onload = () => {\n      callback();\n      removeScript(script);\n    };\n    script.onerror = (e) => {\n      errorCallback(e);\n      removeScript(script);\n    };\n  }\n\n  script.src = url;\n\n  if (document.body) document.body.appendChild(script);\n  else document.head.appendChild(script);\n}\n","import { endsWith, isUndefined, startsWith } from 'lodash-es';\nimport {\n  CAMPAIGN_KEYS,\n  KEY_OUTGOING_IGNORE_SUBDOMAIN,\n  SECOND_LEVEL_TLDS,\n  XDM_PARAM_NAME\n} from './constants';\nimport globals from './globals';\nimport * as docCookies from './lib/cookies';\nimport { addEventListener, fire, on } from './lib/events';\nimport { serializeForm } from './lib/form';\nimport { loadScript, removeScript } from './lib/script';\nimport { getElement, isLeftClick, randomString } from './lib/utils';\n\nconst Woopra = {};\n\nWoopra.docCookies = docCookies;\n\n/**\n * Wrapper for window.location to allow stubs in testing\n */\nWoopra.location = function location(property, value) {\n  // make sure property is valid\n  if (!isUndefined(window.location[property])) {\n    if (!isUndefined(value)) {\n      window.location[property] = value;\n    } else {\n      return window.location[property];\n    }\n  }\n};\n\nfunction getHostname() {\n  return Woopra.location('hostname');\n}\n\n/**\n * This exists to please the Safari gods. Sinon can't stub window in Safari.\n */\nWoopra.historyReplaceState =\n  window.history && window.history.replaceState\n    ? function historyReplaceState(data, title, url) {\n        return window.history.replaceState(data, title, url);\n      }\n    : function () {};\n\n/**\n * Hides any URL parameters by calling window.history.replaceState\n *\n * @param {Array} params A list of parameter prefixes that will be hidden\n * @return {String} Returns the new URL that will be used\n */\nWoopra.hideUrlParams = function hideUrlParams(params) {\n  const regex = new RegExp(\n    `[?&]+((?:${params.join('|')})[^=&]*)=([^&#]*)`,\n    'gi'\n  );\n  const href = Woopra.location('href').replace(regex, '');\n\n  Woopra.historyReplaceState(null, null, href);\n\n  return href;\n};\n\n/**\n * Retrieves the current URL parameters as an object\n *\n * @return {Object} An object for all of the URL parameters\n */\nWoopra.getUrlParams = function getUrlParams() {\n  const vars = {};\n  const href = Woopra.location('href');\n\n  if (href) {\n    href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {\n      vars[key] = decodeURIComponent(value.split('+').join(' '));\n    });\n  }\n\n  return vars;\n};\n\nWoopra.buildUrlParams = function buildUrlParams(params, prefix = '') {\n  const p = [];\n\n  if (isUndefined(params)) {\n    return params;\n  }\n\n  for (let key in params) {\n    if (params.hasOwnProperty(key)) {\n      if (\n        params[key] !== 'undefined' &&\n        params[key] !== 'null' &&\n        !isUndefined(params[key])\n      ) {\n        p.push(\n          `${prefix}${encodeURIComponent(key)}=${encodeURIComponent(\n            params[key]\n          )}`\n        );\n      }\n    }\n  }\n  return p.join('&');\n};\n\n/**\n * Parses the URL parameters for data beginning with a certain prefix\n *\n * @param {Function} method The callback method for each key found matching `prefix`\n * @param {string} prefix The prefix that the parameter should start with\n */\nWoopra.getCustomData = function getCustomData(method, prefix = 'wv_') {\n  const vars = Woopra.getUrlParams();\n\n  for (let i in vars) {\n    if (vars.hasOwnProperty(i)) {\n      const value = vars[i];\n\n      if (i.substring(0, prefix.length) === prefix) {\n        const key = i.substring(prefix.length);\n        method.call(this, key, value);\n      }\n    }\n  }\n};\n\n/**\n * Retrieves the current client domain name using the hostname\n * and returning the last two tokens with a `.` separator (domain + tld).\n *\n * This can be an issue if there is a second level domain\n */\nWoopra.getDomain = function getDomain(hostname = getHostname()) {\n  const domain = hostname.substring(\n    hostname.lastIndexOf('.', hostname.lastIndexOf('.') - 1) + 1\n  );\n\n  // check if domain is in list of second level domains, ignore if so\n  if (SECOND_LEVEL_TLDS.indexOf(domain) !== -1) {\n    return hostname.substring(\n      hostname.lastIndexOf('.', hostname.indexOf(domain) - 2) + 1\n    );\n  }\n\n  return domain;\n};\n\n/**\n * Returns the current hostname with 'www' stripped out\n */\nWoopra.getHostnameNoWww = function getHostnameNoWww() {\n  const hostname = getHostname();\n\n  if (hostname.indexOf('www.') === 0) {\n    return hostname.replace('www.', '');\n  }\n\n  return hostname;\n};\n\n/**\n * Determines if the current URL should be considered an outgoing URL\n */\nWoopra.isOutgoingLink = function isOutgoingLink(targetHostname) {\n  const currentHostname = getHostname();\n  const currentDomain = Woopra.getDomain(currentHostname);\n\n  return (\n    targetHostname !== currentHostname &&\n    targetHostname.replace(/^www\\./, '') !==\n      currentHostname.replace(/^www\\./, '') &&\n    (!globals[KEY_OUTGOING_IGNORE_SUBDOMAIN] ||\n      currentDomain !== Woopra.getDomain(targetHostname)) &&\n    !Woopra.startsWith(targetHostname, 'javascript') &&\n    targetHostname !== '' &&\n    targetHostname !== '#'\n  );\n};\n\nWoopra.hideCrossDomainId = function hideCrossDomainId() {\n  return Woopra.hideUrlParams([XDM_PARAM_NAME]);\n};\n\nWoopra.mapQueryParams = function mapQueryParams(mapping) {\n  const vars = Woopra.getUrlParams();\n  const params = {};\n\n  for (let key in mapping) {\n    const value = vars[key];\n    if (!isUndefined(value)) {\n      params[mapping[key]] = value;\n    }\n  }\n\n  return params;\n};\n\nWoopra.redirect = function redirect(link) {\n  Woopra.location('href', link);\n};\n\n/**\n * Parses current URL for parameters that start with either `utm_` or `woo_`\n * and have the keys `source`, `medium`, `content`, `campaign`, `term`\n *\n * @return {Object} Returns an object with campaign keys as keys\n */\nWoopra.getCampaignData = function getCampaignData() {\n  const vars = Woopra.getUrlParams();\n  const campaign = {};\n\n  for (let i = 0; i < CAMPAIGN_KEYS.length; i++) {\n    const key = CAMPAIGN_KEYS[i];\n    const value = vars[`utm_${key}`] || vars[`woo_${key}`];\n\n    if (!isUndefined(value)) {\n      campaign[`campaign_${key === 'campaign' ? 'name' : key}`] = value;\n    }\n  }\n\n  return campaign;\n};\n\n/**\n * Hides any campaign data (query params: wv_, woo_, utm_) from the URL\n * by using replaceState (if available)\n */\nWoopra.hideCampaignData = function hideCampaignData() {\n  return Woopra.hideUrlParams(['wv_', 'woo_', 'utm_']);\n};\n\nWoopra.leftClick = isLeftClick;\nWoopra.randomString = randomString;\nWoopra.getElement = getElement;\nWoopra.loadScript = loadScript;\nWoopra.removeScript = removeScript;\nWoopra.serializeForm = serializeForm;\nWoopra._on = on;\nWoopra._fire = fire;\nWoopra.attachEvent = addEventListener;\nWoopra.startsWith = startsWith;\nWoopra.endsWith = endsWith;\n\nexport default Woopra;\n","import baseClamp from './_baseClamp.js';\nimport baseToString from './_baseToString.js';\nimport toInteger from './toInteger.js';\nimport toString from './toString.js';\n\n/**\n * Checks if `string` starts with the given target string.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to inspect.\n * @param {string} [target] The string to search for.\n * @param {number} [position=0] The position to search from.\n * @returns {boolean} Returns `true` if `string` starts with `target`,\n *  else `false`.\n * @example\n *\n * _.startsWith('abc', 'a');\n * // => true\n *\n * _.startsWith('abc', 'b');\n * // => false\n *\n * _.startsWith('abc', 'b', 1);\n * // => true\n */\nfunction startsWith(string, target, position) {\n  string = toString(string);\n  position = position == null\n    ? 0\n    : baseClamp(toInteger(position), 0, string.length);\n\n  target = baseToString(target);\n  return string.slice(position, position + target.length) == target;\n}\n\nexport default startsWith;\n","import baseClamp from './_baseClamp.js';\nimport baseToString from './_baseToString.js';\nimport toInteger from './toInteger.js';\nimport toString from './toString.js';\n\n/**\n * Checks if `string` ends with the given target string.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to inspect.\n * @param {string} [target] The string to search for.\n * @param {number} [position=string.length] The position to search up to.\n * @returns {boolean} Returns `true` if `string` ends with `target`,\n *  else `false`.\n * @example\n *\n * _.endsWith('abc', 'c');\n * // => true\n *\n * _.endsWith('abc', 'b');\n * // => false\n *\n * _.endsWith('abc', 'b', 2);\n * // => true\n */\nfunction endsWith(string, target, position) {\n  string = toString(string);\n  target = baseToString(target);\n\n  var length = string.length;\n  position = position === undefined\n    ? length\n    : baseClamp(toInteger(position), 0, length);\n\n  var end = position;\n  position -= target.length;\n  return position >= 0 && string.slice(position, end) == target;\n}\n\nexport default endsWith;\n","import {\n  isArray,\n  isFunction,\n  isObject,\n  isString,\n  isUndefined,\n  noop\n} from 'lodash-es';\nimport WoopraAction from './action';\nimport {\n  ACTION_PROPERTY_ALIASES,\n  ACTION_PROPERTY_PREFIX,\n  ACTION_PV,\n  DATA_TRACKED_ATTRIBUTE,\n  DEFAULT_DOWNLOAD_EXTENSIONS,\n  ELEMENT_MATCHER_CLICK,\n  ENDPOINT,\n  ENDPOINT_IDENTIFY,\n  ENDPOINT_TRACK,\n  ENDPOINT_UPDATE,\n  EVENT_CLICK,\n  EVENT_DOWNLOAD,\n  EVENT_LINK_CLICK,\n  EVENT_MOUSEMOVE,\n  EVENT_OUTGOING,\n  EVENT_SCROLL,\n  EVENT_STATECHANGE,\n  IDPTNC,\n  KEY_APP,\n  KEY_AUTO_DECORATE,\n  KEY_BEACONS,\n  KEY_CAMPAIGN_ONCE,\n  KEY_CLICK_PAUSE,\n  KEY_CLICK_TRACKING,\n  KEY_CONTEXT,\n  KEY_COOKIE_DOMAIN,\n  KEY_COOKIE_EXPIRE,\n  KEY_COOKIE_NAME,\n  KEY_COOKIE_PATH,\n  KEY_CROSS_DOMAIN,\n  KEY_DOMAIN,\n  KEY_DOWNLOAD_EXTENSIONS,\n  KEY_DOWNLOAD_PAUSE,\n  KEY_DOWNLOAD_TRACKING,\n  KEY_FORM_PAUSE,\n  KEY_HIDE_CAMPAIGN,\n  KEY_HIDE_XDM_DATA,\n  KEY_IDLE_THRESHOLD,\n  KEY_IDLE_TIMEOUT,\n  KEY_IGNORE_QUERY_URL,\n  KEY_IP,\n  KEY_MAP_QUERY_PARAMS,\n  KEY_OUTGOING_IGNORE_SUBDOMAIN,\n  KEY_OUTGOING_PAUSE,\n  KEY_OUTGOING_TRACKING,\n  KEY_PERSONALIZATION,\n  KEY_PING,\n  KEY_PING_INTERVAL,\n  KEY_PROTOCOL,\n  KEY_SAVE_URL_HASH,\n  KEY_THIRD_PARTY,\n  KEY_USE_COOKIES,\n  LIFECYCLE_ACTION,\n  LIFECYCLE_PAGE,\n  MAX_PING_INTERVAL,\n  META_CANCELLED,\n  META_DIRTY,\n  META_DURATION,\n  META_EXPIRED,\n  META_LEAVE,\n  META_RETRACK,\n  META_SENT,\n  META_TIMESTAMP,\n  MIN_PING_INTERVAL,\n  PAGE_LIFECYCLE_STATE_ACTIVE,\n  PAGE_LIFECYCLE_STATE_HIDDEN,\n  PAGE_LIFECYCLE_STATE_PASSIVE,\n  PAGE_LIFECYCLE_STATE_TERMINATED,\n  SCROLL_DEPTH,\n  TARGET_BLANK,\n  URL_ID_REGEX,\n  VERSION,\n  VISITOR_PROPERTY_PREFIX,\n  VISIT_PROPERTY_PREFIX,\n  XDM_PARAM_NAME\n} from './constants';\nimport globals from './globals';\nimport { addEventListener, on, removeHandler } from './lib/events';\nimport {\n  callCallback,\n  findParentElement,\n  getElement,\n  getScrollDepth,\n  hasBeaconSupport,\n  prefixObjectKeys,\n  randomString\n} from './lib/utils';\nimport Woopra from './woopra';\n\nconst fire = Woopra._fire;\n\nexport default class Tracker {\n  constructor(instanceName) {\n    this.visitorData = {};\n    this.sessionData = {};\n\n    this.options = {\n      [KEY_APP]: 'js-client',\n      [KEY_BEACONS]: hasBeaconSupport(),\n      [KEY_CAMPAIGN_ONCE]: false,\n      [KEY_COOKIE_DOMAIN]: `.${Woopra.getHostnameNoWww()}`,\n      [KEY_COOKIE_EXPIRE]: new Date(\n        new Date().setDate(new Date().getDate() + 730)\n      ),\n      [KEY_COOKIE_NAME]: 'wooTracker',\n      [KEY_COOKIE_PATH]: '/',\n      [KEY_CROSS_DOMAIN]: false,\n      [KEY_DOWNLOAD_EXTENSIONS]: DEFAULT_DOWNLOAD_EXTENSIONS,\n      [KEY_DOWNLOAD_PAUSE]: 200,\n      [KEY_DOWNLOAD_TRACKING]: false,\n      [KEY_HIDE_CAMPAIGN]: false,\n      [KEY_HIDE_XDM_DATA]: false,\n      [KEY_IDLE_THRESHOLD]: 10 * 1_000,\n      [KEY_IDLE_TIMEOUT]: 60 * 10 * 1_000,\n      [KEY_IGNORE_QUERY_URL]: false,\n      [KEY_MAP_QUERY_PARAMS]: {},\n      [KEY_OUTGOING_IGNORE_SUBDOMAIN]: true,\n      [KEY_OUTGOING_PAUSE]: 200,\n      [KEY_OUTGOING_TRACKING]: false,\n      [KEY_PERSONALIZATION]: true,\n      [KEY_PING_INTERVAL]: 12 * 1_000,\n      [KEY_PING]: false,\n      [KEY_PROTOCOL]: 'https',\n      [KEY_SAVE_URL_HASH]: true,\n      [KEY_THIRD_PARTY]: false,\n      [KEY_CLICK_PAUSE]: 250,\n      [KEY_FORM_PAUSE]: 250,\n      [KEY_USE_COOKIES]: true\n    };\n\n    this.instanceName = instanceName || 'woopra';\n    this.idle = 0;\n    this.cookie = '';\n    this.last_activity = Date.now();\n    this.loaded = false;\n    this.dirtyCookie = false;\n    this.sentCampaign = false;\n    this.version = VERSION;\n    this.pending = [];\n    this.beaconQueue = [];\n    this.lastAction = null;\n\n    if (instanceName && instanceName !== '') {\n      window[instanceName] = this;\n    }\n  }\n\n  init() {\n    this.__l = {};\n    this._processQueue('config');\n    this._setupCookie();\n    this._bindEvents();\n\n    // Otherwise loading indicator gets stuck until the every response\n    // in the queue has been received\n    setTimeout(() => this._processQueue(), 1);\n\n    this.loaded = true;\n\n    const callback = this.config('initialized');\n\n    if (isFunction(callback)) {\n      callback(this.instanceName);\n    }\n\n    // Safe to remove cross domain url parameter after setupCookie is called\n    // Should only need to be called once on load\n    if (this.config(KEY_HIDE_XDM_DATA)) {\n      Woopra.hideCrossDomainId();\n    }\n  }\n\n  /**\n   * Processes the tracker queue in case user tries to push events\n   * before tracker is ready.\n   */\n  _processQueue(type) {\n    var _wpt = window.__woo ? window.__woo[this.instanceName] : _wpt;\n    _wpt = window._w ? window._w[this.instanceName] : _wpt;\n\n    // if _wpt is undefined, means script was loaded asynchronously and\n    // there is no queue\n\n    if (_wpt && _wpt._e) {\n      const events = _wpt._e;\n      for (let i = 0; i < events.length; i++) {\n        const action = events[i];\n        if (\n          !isUndefined(action) &&\n          this[action[0]] &&\n          (isUndefined(type) || type === action[0])\n        ) {\n          this[action[0]].apply(this, Array.prototype.slice.call(action, 1));\n        }\n      }\n    }\n  }\n\n  /**\n   * Sets up the tracking cookie\n   */\n  _setupCookie() {\n    const url_id = this.getUrlId();\n\n    this.cookie = this.getCookie();\n\n    // overwrite saved cookie if id is in url\n    if (url_id) {\n      this.cookie = url_id;\n    }\n\n    // Setup cookie\n    if (!this.cookie || this.cookie.length < 1) {\n      this.cookie = randomString();\n    }\n\n    Woopra.docCookies.setItem(\n      this.config(KEY_COOKIE_NAME),\n      this.cookie,\n      this.config(KEY_COOKIE_EXPIRE),\n      this.config(KEY_COOKIE_PATH),\n      this.config(KEY_COOKIE_DOMAIN)\n    );\n\n    this.dirtyCookie = true;\n  }\n\n  /**\n   * Binds some events to measure mouse and keyboard events\n   */\n  _bindEvents() {\n    on(this, EVENT_CLICK, (e) => this.onClick(e));\n    on(this, EVENT_DOWNLOAD, (url) => this.downloaded(url));\n    on(this, EVENT_LINK_CLICK, (e, link) => this.onLink(e, link));\n    on(this, EVENT_MOUSEMOVE, (e, l) => this.moved(e, l));\n    on(this, EVENT_OUTGOING, (url) => this.outgoing(url));\n    on(this, EVENT_SCROLL, (elem) => this.onScroll(elem));\n    on(this, EVENT_STATECHANGE, (e) => this.onPageStateChange(e));\n    on(this, KEY_AUTO_DECORATE, (elem) => this.autoDecorate(elem));\n  }\n\n  /**\n   * Sets/gets values from dataStore depending on arguments passed\n   *\n   * @param dataStore Object The tracker property to read/write\n   * @param key String/Object Returns property object if key and value is undefined,\n   *      acts as a getter if only `key` is defined and a string, and\n   *      acts as a setter if `key` and `value` are defined OR if `key` is an object.\n   */\n  _dataSetter(dataStore, key, value) {\n    if (isUndefined(key)) {\n      return dataStore;\n    }\n\n    if (isUndefined(value)) {\n      if (isString(key)) {\n        return dataStore[key];\n      }\n      if (isObject(key)) {\n        for (let i in key) {\n          if (key.hasOwnProperty(i)) {\n            if (Woopra.startsWith(i, 'cookie_')) {\n              this.dirtyCookie = true;\n            }\n            dataStore[i] = key[i];\n          }\n        }\n      }\n    } else {\n      if (Woopra.startsWith(key, 'cookie_')) {\n        this.dirtyCookie = true;\n      }\n      dataStore[key] = value;\n    }\n\n    return this;\n  }\n\n  getVisitorUrlData() {\n    Woopra.getCustomData.call(this, this.identify, 'wv_');\n  }\n\n  /*\n   * Returns the Woopra cookie string\n   */\n  getCookie() {\n    return Woopra.docCookies.getItem(this.config(KEY_COOKIE_NAME));\n  }\n\n  getProtocol() {\n    const protocol = this.config(KEY_PROTOCOL);\n    return protocol && protocol !== '' ? `${protocol}:` : '';\n  }\n\n  /**\n   * Generates a destination endpoint string to use depending on different\n   * configuration options\n   */\n  getEndpoint(path = '') {\n    const protocol = this.getProtocol();\n\n    if (this.config(KEY_THIRD_PARTY) && !this.config(KEY_DOMAIN)) {\n      throw new Error('Error: `domain` is not set.');\n    }\n\n    let thirdPartyPath = this.config(KEY_THIRD_PARTY)\n      ? `tp/${this.config(KEY_DOMAIN)}`\n      : '';\n\n    if (path && !Woopra.endsWith(path, '/')) {\n      path += '/';\n    }\n\n    if (thirdPartyPath && !Woopra.startsWith(path, '/')) {\n      thirdPartyPath += '/';\n    }\n\n    return `${protocol}//${ENDPOINT}${thirdPartyPath}${path}`;\n  }\n\n  /**\n   * Sets configuration options\n   */\n  config(key, value) {\n    const data = this._dataSetter(this.options, key, value);\n\n    // dataSetter returns `this` when it is used as a setter\n    if (data === this) {\n      // clamp ping interval\n      this.options[KEY_PING_INTERVAL] = Math.max(\n        MIN_PING_INTERVAL,\n        Math.min(this.options[KEY_PING_INTERVAL], MAX_PING_INTERVAL)\n      );\n\n      // set script wide variables for events that are bound on script load\n      // since we shouldn't bind per tracker instance\n      globals[KEY_OUTGOING_TRACKING] = this.options[KEY_OUTGOING_TRACKING];\n      globals[KEY_DOWNLOAD_TRACKING] = this.options[KEY_DOWNLOAD_TRACKING];\n      globals[KEY_AUTO_DECORATE] =\n        isUndefined(globals[KEY_AUTO_DECORATE]) &&\n        this.options[KEY_CROSS_DOMAIN]\n          ? this.options[KEY_CROSS_DOMAIN]\n          : globals[KEY_AUTO_DECORATE];\n      globals[KEY_OUTGOING_IGNORE_SUBDOMAIN] =\n        this.options[KEY_OUTGOING_IGNORE_SUBDOMAIN];\n\n      if (this.dirtyCookie && this.loaded) {\n        this._setupCookie();\n      }\n    }\n\n    return data;\n  }\n\n  /**\n   * Use to attach custom visit data that doesn't stick to visitor\n   * ** Not in use yet\n   */\n  visit(key, value) {\n    return this._dataSetter(this.sessionData, key, value);\n  }\n\n  /**\n   * Attach custom visitor data\n   */\n  identify(key, value) {\n    return this._dataSetter(this.visitorData, key, value);\n  }\n\n  /**\n   * Generic method to call any tracker method\n   */\n  call(funcName) {\n    if (isFunction(this[funcName])) {\n      this[funcName].apply(this, Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Builds the correct tracking Url and performs an HTTP request\n   */\n  _push(options = {}) {\n    const types = [\n      ['visitorData', VISITOR_PROPERTY_PREFIX],\n      ['eventData', ACTION_PROPERTY_PREFIX],\n      ['sessionData', VISIT_PROPERTY_PREFIX]\n    ];\n\n    let data = {};\n\n    const endpoint = this.getEndpoint(options.endpoint);\n    const lifecycle = options.lifecycle || LIFECYCLE_ACTION;\n\n    // Load custom visitor params from url\n    this.getVisitorUrlData();\n\n    if (this.config(KEY_HIDE_CAMPAIGN)) {\n      Woopra.hideCampaignData();\n    }\n\n    // push tracker config values\n    this._dataSetter(data, this.getOptionParams());\n\n    // push eventName if it exists\n    if (options.eventName) {\n      data.event = options.eventName;\n    }\n\n    // push close if no personalization\n    if (!this.config(KEY_PERSONALIZATION)) {\n      data.close = true;\n    }\n\n    data.timeout = isUndefined(options.timeout)\n      ? this.config(KEY_IDLE_TIMEOUT)\n      : options.timeout;\n\n    const rawData = {};\n\n    for (const [original, alias] of ACTION_PROPERTY_ALIASES) {\n      if (options.eventData && options.eventData[original]) {\n        rawData[alias] = options.eventData[original];\n      }\n    }\n\n    this._dataSetter(data, rawData);\n\n    for (let i = 0; i < types.length; i++) {\n      const [key, prefix] = types[i];\n\n      this._dataSetter(\n        data,\n        prefixObjectKeys(\n          options[key],\n          prefix,\n          prefix === ACTION_PROPERTY_PREFIX ? ACTION_PROPERTY_ALIASES : []\n        )\n      );\n    }\n\n    if (this.config(KEY_CONTEXT)) {\n      try {\n        var contextData = JSON.stringify(this.config(KEY_CONTEXT));\n        data[KEY_CONTEXT] = encodeURIComponent(contextData);\n      } catch (e) {}\n    }\n\n    if (options.fullEventData) data = options.fullEventData;\n\n    const dirty = Boolean(\n      lifecycle === LIFECYCLE_PAGE || options.useBeacon || this.isUnloading\n    );\n\n    const meta = {\n      [META_DIRTY]: dirty,\n      [META_DURATION]: 0,\n      [META_RETRACK]: Boolean(options.retrack),\n      [META_SENT]: !dirty,\n      [META_TIMESTAMP]: Date.now()\n    };\n\n    const action = new WoopraAction(this, data[IDPTNC], data, meta);\n\n    const callback = isFunction(options.callback)\n      ? () => options.callback(action)\n      : noop;\n    const beforeCallback = isFunction(options.beforeCallback)\n      ? () => options.beforeCallback(action)\n      : noop;\n    const errorCallback = options.errorCallback || noop;\n\n    if (lifecycle === LIFECYCLE_PAGE || options.useBeacon || this.isUnloading) {\n      this.pending.push({\n        lifecycle,\n        endpoint: options.endpoint,\n        params: data,\n        args: options,\n        meta,\n        callback,\n        errorCallback\n      });\n    }\n\n    if (lifecycle !== LIFECYCLE_PAGE && options.endpoint === ENDPOINT_TRACK) {\n      this.lastAction = action;\n    }\n\n    if (this.isUnloading || (options.useBeacon && !options.queue)) {\n      this.sendBeacons();\n    } else {\n      const queryString = Woopra.buildUrlParams(data);\n      const scriptUrl = `${endpoint}?${queryString}`;\n\n      const onSuccess = () => callCallback(callback, data.event);\n      const onError = () => callCallback(errorCallback, data.event);\n\n      Woopra.loadScript(scriptUrl, onSuccess, onError);\n    }\n\n    setTimeout(() => callCallback(beforeCallback, data.event));\n  }\n\n  /**\n   * Send an event to tracking servr\n   */\n  track(name, options) {\n    let eventData = {};\n    let eventName = '';\n    let hash;\n    let callback;\n    let beforeCallback;\n    let errorCallback;\n    let lastArg = arguments[arguments.length - 1];\n    let lifecycle = LIFECYCLE_ACTION;\n    let queue = false;\n    let useBeacon = false;\n    let timeout;\n    let retrack;\n\n    if (isFunction(lastArg)) callback = lastArg;\n    else if (isObject(lastArg)) {\n      if (isFunction(lastArg.callback)) callback = lastArg.callback;\n      else if (isFunction(lastArg.onSuccess)) callback = lastArg.onSuccess;\n      if (isFunction(lastArg.onBeforeSend))\n        beforeCallback = lastArg.onBeforeSend;\n      if (isFunction(lastArg.onError)) errorCallback = lastArg.onError;\n\n      if (!isUndefined(lastArg.lifecycle)) lifecycle = lastArg.lifecycle;\n      if (!isUndefined(lastArg.timeout)) timeout = lastArg.timeout;\n      if (!isUndefined(lastArg.retrack)) retrack = lastArg.retrack;\n\n      if (this.config(KEY_BEACONS)) {\n        if (!isUndefined(lastArg.queue)) queue = Boolean(lastArg.queue);\n\n        if (!isUndefined(lastArg.useBeacon)) {\n          useBeacon = Boolean(lastArg.useBeacon);\n        } else if (queue) useBeacon = true;\n      } else {\n        useBeacon = false;\n      }\n    }\n\n    // Load campaign params (load first to allow overrides)\n    if (!this.config(KEY_CAMPAIGN_ONCE) || !this.sentCampaign) {\n      eventData = { ...eventData, ...Woopra.getCampaignData() };\n      this.sentCampaign = true;\n    }\n\n    // Load query params mapping into Woopra event\n    eventData = {\n      ...eventData,\n      ...Woopra.mapQueryParams(this.config(KEY_MAP_QUERY_PARAMS))\n    };\n\n    // Track default: pageview\n    if (isUndefined(name) || name === callback) {\n      eventName = ACTION_PV;\n    }\n    // Track custom events\n    else if (isUndefined(options) || options === callback) {\n      if (isString(name)) {\n        eventName = name;\n      }\n      if (isObject(name)) {\n        if (name.name && name.name === ACTION_PV) {\n          eventName = ACTION_PV;\n        }\n\n        this._dataSetter(eventData, name);\n      }\n    }\n    // Track custom events in format of name,object\n    else {\n      this._dataSetter(eventData, options);\n      eventName = name;\n    }\n\n    eventData[IDPTNC] = randomString();\n\n    // Add some defaults for pageview\n    if (eventName === ACTION_PV) {\n      eventData.url = eventData.url || this.getPageUrl();\n      eventData.title = eventData.title || this.getPageTitle();\n      eventData.domain = eventData.domain || this.getDomainName();\n      eventData.uri = eventData.uri || this.getURI();\n      eventData[SCROLL_DEPTH] = getScrollDepth();\n      eventData.returning = isUndefined(eventData.returning)\n        ? false\n        : eventData.returning;\n\n      if (!lastArg || !lastArg.lifecycle) lifecycle = LIFECYCLE_PAGE;\n\n      if (this.config(KEY_SAVE_URL_HASH)) {\n        hash = eventData.hash || this.getPageHash();\n        if (hash !== '' && hash !== '#') {\n          eventData.hash = hash;\n        }\n      }\n    }\n\n    this._push({\n      endpoint: ENDPOINT_TRACK,\n      visitorData: this.visitorData,\n      sessionData: this.sessionData,\n      eventName,\n      eventData,\n      lifecycle,\n      callback,\n      beforeCallback,\n      errorCallback,\n      queue,\n      useBeacon,\n      retrack,\n      timeout\n    });\n\n    this.startPing();\n\n    return this;\n  }\n\n  update(idptnc, options, lastArg) {\n    let callback;\n    let beforeCallback;\n    let errorCallback;\n    let queue = false;\n    let useBeacon = true;\n\n    if (isFunction(lastArg)) callback = lastArg;\n    else if (isObject(lastArg)) {\n      if (isFunction(lastArg.callback)) callback = lastArg.callback;\n      else if (isFunction(lastArg.onSuccess)) callback = lastArg.onSuccess;\n      if (isFunction(lastArg.onBeforeSend))\n        beforeCallback = lastArg.onBeforeSend;\n      if (isFunction(lastArg.onError)) errorCallback = lastArg.onError;\n\n      if (this.config(KEY_BEACONS)) {\n        if (!isUndefined(lastArg.queue)) queue = Boolean(lastArg.queue);\n\n        if (!isUndefined(lastArg.useBeacon)) {\n          useBeacon = Boolean(lastArg.useBeacon);\n        } else if (queue) useBeacon = true;\n      } else {\n        useBeacon = false;\n      }\n    }\n\n    const eventData = {\n      [IDPTNC]: idptnc,\n      project: this.config(KEY_DOMAIN) || Woopra.getHostnameNoWww()\n    };\n\n    const rawData = {};\n\n    for (const [original, alias] of ACTION_PROPERTY_ALIASES) {\n      if (options && options[original]) {\n        rawData[alias] = options[original];\n      }\n    }\n\n    if (this.config(KEY_USE_COOKIES)) {\n      rawData.cookie = this.getCookie() || this.cookie;\n    }\n\n    this._dataSetter(eventData, rawData);\n\n    this._dataSetter(\n      eventData,\n      prefixObjectKeys(options, ACTION_PROPERTY_PREFIX, ACTION_PROPERTY_ALIASES)\n    );\n\n    this._push({\n      endpoint: ENDPOINT_UPDATE,\n      fullEventData: eventData,\n      callback,\n      beforeCallback,\n      errorCallback,\n      queue,\n      useBeacon\n    });\n\n    return this;\n  }\n\n  cancelAction(idptnc) {\n    let hasCancelled = false;\n\n    if (this.lastAction?.id === idptnc) {\n      this.lastAction = null;\n    }\n\n    this.pending = this.pending.map((item) => {\n      if (item.params[IDPTNC] === idptnc) {\n        hasCancelled = true;\n\n        return {\n          ...item,\n          meta: {\n            ...item.meta,\n            [META_CANCELLED]: true,\n            [META_DIRTY]: true,\n            [META_DURATION]:\n              item.lifecycle === LIFECYCLE_PAGE\n                ? item.meta[META_DURATION] +\n                  (Date.now() - item.meta[META_TIMESTAMP])\n                : item.meta[META_DURATION],\n            [META_RETRACK]: false\n          }\n        };\n      }\n\n      return item;\n    });\n\n    if (hasCancelled) {\n      this.sendBeacons();\n    }\n  }\n\n  /**\n   * Tracks a single form and then resubmits it\n   */\n  trackForm(eventName = 'Tracked Form', selector, options) {\n    let els;\n    const _options = isString(selector) ? options || {} : selector || {};\n\n    const bindEl = (el, ev, props, opts) => {\n      addEventListener(el, 'submit', (e) => {\n        this.trackFormHandler(e, el, ev, _options);\n      });\n    };\n\n    if (_options.elements) {\n      els = _options.elements;\n    } else {\n      els = getElement(selector, _options);\n    }\n\n    // attach event if form was found\n    if (els && els.length > 0) {\n      for (let i in els) {\n        bindEl(els[i], eventName, _options);\n      }\n    }\n  }\n\n  trackFormHandler(e, el, eventName, options = {}) {\n    let trackFinished = false;\n\n    if (!el.getAttribute(DATA_TRACKED_ATTRIBUTE)) {\n      const useBeacon = Boolean(this.config(KEY_BEACONS));\n\n      const properties = Woopra.serializeForm(el, options);\n\n      if (isFunction(options.identify)) {\n        const personData = options.identify(properties) || {};\n\n        if (personData) {\n          this.identify(personData);\n        }\n      }\n\n      const onBeforeSend = isFunction(options.onBeforeSend)\n        ? options.onBeforeSend\n        : undefined;\n      const onSuccess = isFunction(options.callback)\n        ? () => options.callback(properties)\n        : undefined;\n      const onError = isFunction(options.onError) ? options.onError : undefined;\n\n      if (!options.noSubmit) el.setAttribute(DATA_TRACKED_ATTRIBUTE, 1);\n\n      if (options.noSubmit || useBeacon) {\n        this.track(eventName, properties, {\n          onBeforeSend,\n          onError,\n          onSuccess,\n          useBeacon\n        });\n      } else {\n        e.preventDefault();\n        e.stopPropagation();\n\n        // set timeout to resubmit (default 250ms)\n        // so even if woopra does not reply it will still\n        // submit the form\n        const timer = setTimeout(() => {\n          if (!trackFinished) {\n            el.submit();\n          }\n        }, this.config(KEY_FORM_PAUSE));\n\n        this.track(eventName, properties, {\n          onBeforeSend,\n          onSuccess() {\n            clearTimeout(timer);\n\n            if (onSuccess) onSuccess();\n\n            if (!trackFinished) el.submit();\n\n            trackFinished = true;\n          },\n          onError\n        });\n      }\n    }\n  }\n\n  /**\n   * Tracks clicks\n   *\n   * @param {String} eventName The name of the event to track\n   * @param {String} selector The id of element to track\n   * @param {Object} properties Any event properties to track with\n   * @param {Object} options (Optional) Options object\n   * @param {Array} options.elements Supports an array of elements (jQuery object)\n   * @param {Boolean} options.noNav (Default: false) If true, will only perform the track event and let the click event bubble up\n   */\n  trackClick(eventName = 'Item Clicked', selector, properties, options = {}) {\n    let els = [];\n\n    const bindEl = (el, ev, props, opts) => {\n      addEventListener(el, EVENT_CLICK, (e) => {\n        this.trackClickHandler(e, el, ev, props, opts);\n      });\n    };\n\n    /**\n     * Support an array of elements\n     */\n    if (options.elements) {\n      els = options.elements;\n    } else {\n      els = getElement(selector, options);\n    }\n\n    if (els) {\n      for (let i = 0; i < els.length; i++) {\n        bindEl(els[i], eventName, properties, options);\n      }\n    }\n  }\n\n  trackClickHandler(e, el, eventName, properties, options) {\n    let trackFinished = false;\n\n    if (!el.getAttribute(DATA_TRACKED_ATTRIBUTE)) {\n      const useBeacon = Boolean(this.config(KEY_BEACONS));\n\n      const onBeforeSend = isFunction(options.onBeforeSend)\n        ? options.onBeforeSend\n        : undefined;\n      const onSuccess = isFunction(options.callback)\n        ? () => options.callback(properties)\n        : undefined;\n      const onError = isFunction(options.onError) ? options.onError : undefined;\n\n      if (!options.noNav) el.setAttribute(DATA_TRACKED_ATTRIBUTE, 1);\n\n      if (options.noNav || useBeacon) {\n        this.track(eventName, properties, {\n          onBeforeSend,\n          onError,\n          onSuccess,\n          useBeacon\n        });\n      } else {\n        e.preventDefault();\n\n        // set timeout to resubmit (default 250ms)\n        // so even if woopra does not reply it will still\n        // click the link\n        const timer = setTimeout(() => {\n          if (!trackFinished) {\n            el.click();\n          }\n        }, this.config(KEY_CLICK_PAUSE));\n\n        this.track(eventName, properties, {\n          onBeforeSend,\n          onSuccess() {\n            clearTimeout(timer);\n\n            if (onSuccess) onSuccess();\n\n            if (!trackFinished) el.click();\n\n            trackFinished = true;\n          },\n          onError\n        });\n      }\n    }\n  }\n\n  startPing() {\n    if (isUndefined(this.pingInterval)) {\n      this.pingInterval = setInterval(() => {\n        this.ping();\n      }, this.config(KEY_PING_INTERVAL));\n    }\n  }\n\n  stopPing() {\n    if (!isUndefined(this.pingInterval)) {\n      clearInterval(this.pingInterval);\n      delete this.pingInterval;\n    }\n  }\n\n  /**\n   * Pings tracker with visitor info\n   */\n  ping() {\n    if (this.config(KEY_PING) && this.idle < this.config(KEY_IDLE_TIMEOUT)) {\n      // this._push({\n      //   endpoint: 'ping'\n      // });\n    } else {\n      this.stopPing();\n    }\n\n    const now = Date.now();\n    if (now - this.last_activity > this.config(KEY_IDLE_THRESHOLD)) {\n      this.idle = now - this.last_activity;\n    }\n\n    return this;\n  }\n\n  /**\n   * Pushes visitor data to server without sending an event\n   */\n  push(callback) {\n    this._push({\n      endpoint: ENDPOINT_IDENTIFY,\n      visitorData: this.visitorData,\n      sessionData: this.sessionData,\n      callback\n    });\n\n    this.sendBeacons();\n\n    return this;\n  }\n\n  _updateDurations(oldState, newState) {\n    const now = Date.now();\n\n    function updateDuration(item) {\n      switch (newState) {\n        case PAGE_LIFECYCLE_STATE_ACTIVE:\n        case PAGE_LIFECYCLE_STATE_PASSIVE:\n          if (now - item.meta[META_LEAVE] > item.params.timeout) {\n            return {\n              [META_EXPIRED]: true\n            };\n          }\n\n          if (\n            (newState === PAGE_LIFECYCLE_STATE_ACTIVE &&\n              oldState === PAGE_LIFECYCLE_STATE_PASSIVE) ||\n            (newState === PAGE_LIFECYCLE_STATE_PASSIVE &&\n              oldState === PAGE_LIFECYCLE_STATE_ACTIVE)\n          ) {\n            return {};\n          }\n\n          return {\n            [META_TIMESTAMP]: now\n          };\n\n        case PAGE_LIFECYCLE_STATE_HIDDEN:\n          return {\n            [META_DIRTY]:\n              item.meta[META_DIRTY] || now - item.meta[META_TIMESTAMP] > 100,\n            [META_DURATION]:\n              item.meta[META_DURATION] + (now - item.meta[META_TIMESTAMP]),\n            [META_LEAVE]: now\n          };\n\n        case PAGE_LIFECYCLE_STATE_TERMINATED:\n          return {\n            [META_DIRTY]:\n              item.meta[META_DIRTY] || now - item.meta[META_LEAVE] > 100\n          };\n\n        default:\n          return {};\n      }\n    }\n\n    this.pending = this.pending.map((item) => {\n      if (item.lifecycle !== LIFECYCLE_PAGE) return item;\n\n      return {\n        ...item,\n        meta: {\n          ...item.meta,\n          ...updateDuration(item)\n        }\n      };\n    });\n\n    if (this.lastAction) {\n      this.lastAction = {\n        ...this.lastAction,\n        meta: {\n          ...this.lastAction.meta,\n          ...updateDuration(this.lastAction)\n        }\n      };\n    }\n  }\n\n  _processLifecycle(lifecycle) {\n    const toRetrack = [];\n\n    this.pending.forEach((item) => {\n      if (\n        item.meta[META_EXPIRED] &&\n        !item.meta[META_CANCELLED] &&\n        item.meta[META_RETRACK]\n      ) {\n        toRetrack.push({\n          ...item.args,\n          eventData: {\n            ...(item.args.eventData || {}),\n            [IDPTNC]: randomString(),\n            returning: true\n          }\n        });\n      }\n    });\n\n    toRetrack.forEach((item) => this._push(item));\n\n    this.pending = this.pending.filter((item) => {\n      if (item.meta[META_EXPIRED]) return false;\n\n      if (item.meta[META_DIRTY]) {\n        this.beaconQueue.push({\n          lifecycle: item.lifecycle,\n          endpoint: item.endpoint,\n          params: {\n            ...item.params\n          },\n          meta: {\n            ...item.meta\n          },\n          successCallback: item.callback,\n          errorCallback: item.errorCallback\n        });\n      }\n\n      if (item.meta[META_CANCELLED]) return false;\n\n      if (item.lifecycle === LIFECYCLE_PAGE && lifecycle !== LIFECYCLE_PAGE) {\n        return true;\n      }\n\n      return false;\n    });\n\n    this.pending = this.pending.map((item) => ({\n      ...item,\n      meta: {\n        ...item.meta,\n        [META_DIRTY]: false,\n        [META_SENT]: true\n      }\n    }));\n\n    if (lifecycle === LIFECYCLE_PAGE && this.lastAction) {\n      this.beaconQueue.push({\n        lifecycle: LIFECYCLE_PAGE,\n        endpoint: ENDPOINT_TRACK,\n        params: {\n          ...this.lastAction.params\n        },\n        meta: {\n          ...this.lastAction.meta\n        }\n      });\n    }\n\n    return toRetrack.length > 0;\n  }\n\n  _drainBeaconQueue() {\n    const useCookies = this.config(KEY_USE_COOKIES);\n\n    function isEmptyBeaconParams(params) {\n      const { [IDPTNC]: id, cookie, project, event, ...rest } = params;\n\n      return Object.keys(rest).length > 0;\n    }\n\n    const idMap = this.beaconQueue.reduce((idMap, item) => {\n      idMap[item.params[IDPTNC]] = [];\n\n      return idMap;\n    }, {});\n\n    this.beaconQueue.forEach((item) => {\n      idMap[item.params[IDPTNC]].push(item);\n    });\n\n    this.beaconQueue = [];\n\n    const toSend = Object.keys(idMap)\n      .map((id) => {\n        const items = idMap[id];\n\n        const data = {\n          endpoint: undefined,\n          params: {},\n          onSuccess: [],\n          onError: []\n        };\n\n        items.forEach((item) => {\n          if (!data.endpoint) {\n            if (item.endpoint === ENDPOINT_TRACK && item.meta[META_SENT]) {\n              data.endpoint = ENDPOINT_UPDATE;\n            } else {\n              data.endpoint = item.endpoint;\n            }\n          }\n\n          data.params.project = item.params.project;\n          data.params.event = item.params.event;\n          data.params[IDPTNC] = item.params[IDPTNC];\n\n          if (useCookies) {\n            data.params.cookie = this.getCookie() || this.cookie;\n          }\n\n          if (\n            (item.lifecycle === LIFECYCLE_PAGE ||\n              item.params[IDPTNC] === this.lastAction?.id) &&\n            item.meta[META_DURATION] > 0\n          ) {\n            data.params.duration = item.meta[META_DURATION];\n          }\n\n          if (item.meta[SCROLL_DEPTH]) {\n            data.params[`${ACTION_PROPERTY_PREFIX}${SCROLL_DEPTH}`] =\n              Math.round(item.meta[SCROLL_DEPTH] * 10_000) / 10_000;\n          }\n\n          if (!item.meta[META_SENT]) {\n            data.params = { ...data.params, ...item.params };\n\n            if (isFunction(item.successCallback)) {\n              data.onSuccess.push(item.successCallback);\n            }\n\n            if (isFunction(item.errorCallback)) {\n              data.onError.push(item.errorCallback);\n            }\n          }\n        });\n\n        if (!data.params.project) {\n          data.params.project =\n            this.config(KEY_DOMAIN) || Woopra.getHostnameNoWww();\n        }\n\n        return data;\n      })\n      .filter((item) => isEmptyBeaconParams(item.params));\n\n    if (toSend.length > 0) {\n      if (this.config(KEY_BEACONS)) {\n        const payloads = [''];\n\n        const lines = toSend.map(({ endpoint, params }) =>\n          JSON.stringify({ endpoint, params })\n        );\n\n        // chunk beacons into < 64 KiB chunks\n        lines.forEach((line) => {\n          if (\n            new Blob([`${payloads[payloads.length - 1]}${line}`]).size >= 65_000\n          ) {\n            payloads.push('');\n          }\n          payloads[payloads.length - 1] += `${line}\\n`;\n        });\n\n        payloads.forEach((payload, index) => {\n          const formData = new FormData();\n\n          formData.append('payload', payload.slice(0, -1));\n\n          navigator.sendBeacon.call(\n            navigator,\n            this.getEndpoint('push'),\n            formData\n          );\n        });\n\n        toSend.forEach((item) => {\n          item.onSuccess.forEach((callback) =>\n            callCallback(callback, item.params.event)\n          );\n        });\n      } else {\n        toSend.forEach((item) => {\n          const endpoint = this.getEndpoint(item.endpoint);\n\n          const queryString = Woopra.buildUrlParams({\n            close: true,\n            ...item.params\n          });\n          const scriptUrl = `${endpoint}?${queryString}`;\n\n          const onSuccess = () =>\n            item.onSuccess.forEach((callback) =>\n              callCallback(callback, item.params.event)\n            );\n          const onError = () =>\n            item.onError.forEach((callback) =>\n              callCallback(callback, item.params.event)\n            );\n\n          Woopra.loadScript(scriptUrl, onSuccess, onError);\n        });\n      }\n    }\n  }\n\n  sendBeacons(lifecycle = LIFECYCLE_ACTION) {\n    this._processLifecycle(lifecycle);\n    this._drainBeaconQueue();\n  }\n\n  /**\n   * synchronous sleep\n   */\n  sleep() {\n    // Why does this exist?\n  }\n\n  _touch(last_activity = Date.now()) {\n    this.last_activity = last_activity;\n    this.idle = 0;\n  }\n\n  // User Action tracking and event handlers\n\n  /**\n   * Clicks\n   */\n\n  /**\n   * Measure when the user last moved their mouse to update idle state\n   */\n  moved(e, last_activity) {\n    this._touch(last_activity);\n  }\n\n  onClick(e) {\n    if (!this.config(KEY_CLICK_TRACKING)) return;\n\n    const useBeacon = Boolean(this.config(KEY_BEACONS));\n\n    const { target } = e;\n\n    const clickTarget = findParentElement(target, ELEMENT_MATCHER_CLICK);\n\n    if (clickTarget) {\n      const tagName = clickTarget.tagName.toLowerCase();\n\n      const properties = {\n        'page url': this.getPageUrl(),\n        'page title': this.getPageTitle(),\n        text:\n          clickTarget.innerText || clickTarget.value || clickTarget.textContent,\n        title: clickTarget.textContent,\n        type: tagName === 'a' ? 'link' : clickTarget.type,\n        tagname: tagName,\n        classname: clickTarget.className,\n        url: clickTarget.href\n      };\n\n      if (this.config(KEY_SAVE_URL_HASH)) {\n        const hash = this.getPageHash();\n\n        if (hash !== '' && hash !== '#') {\n          properties['page hash'] = hash;\n        }\n      }\n\n      this.track('button click', properties, {\n        useBeacon\n      });\n    }\n  }\n\n  onLink(e, link) {\n    const useBeacon = Boolean(this.config(KEY_BEACONS));\n    const downloadTypes = this.config(KEY_DOWNLOAD_EXTENSIONS);\n\n    const downloadFileTypeRegexp = new RegExp(\n      `(?:${downloadTypes.join('|')})($|\\&)`,\n      'i'\n    );\n\n    const isDownloadFileType = downloadFileTypeRegexp.test(link.pathname);\n\n    if (this.config(KEY_DOWNLOAD_TRACKING) && isDownloadFileType) {\n      fire(EVENT_DOWNLOAD, link.href);\n\n      if (link.target !== TARGET_BLANK && Woopra.leftClick(e)) {\n        link.setAttribute(DATA_TRACKED_ATTRIBUTE, 1);\n\n        if (!useBeacon) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          setTimeout(() => {\n            link.click();\n          }, this.config(KEY_DOWNLOAD_PAUSE));\n        }\n      }\n    }\n\n    // Make sure\n    // * outgoing tracking is enabled\n    // * this URL does not match a download URL (doesn't end\n    //   in a binary file extension)\n    // * not ignoring subdomains OR link hostname is not a partial\n    //   match of current hostname (to check for subdomains),\n    // * hostname is not empty\n    if (\n      this.config(KEY_OUTGOING_TRACKING) &&\n      !isDownloadFileType &&\n      Woopra.isOutgoingLink(link.hostname)\n    ) {\n      fire(EVENT_OUTGOING, link.href);\n\n      if (link.target !== TARGET_BLANK && Woopra.leftClick(e)) {\n        link.setAttribute(DATA_TRACKED_ATTRIBUTE, 1);\n\n        if (!useBeacon) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          setTimeout(() => {\n            link.click();\n          }, this.config(KEY_OUTGOING_PAUSE));\n        }\n      }\n    }\n  }\n\n  downloaded(url) {\n    const useBeacon = Boolean(this.config(KEY_BEACONS));\n\n    this.track(\n      EVENT_DOWNLOAD,\n      {\n        url\n      },\n      { useBeacon }\n    );\n  }\n\n  outgoing(url) {\n    const useBeacon = Boolean(this.config(KEY_BEACONS));\n\n    this.track(\n      EVENT_OUTGOING,\n      {\n        url\n      },\n      { useBeacon }\n    );\n  }\n\n  onUnload() {\n    if (!this.isUnloading) {\n      this.isUnloading = true;\n      this._updateDurations(\n        PAGE_LIFECYCLE_STATE_HIDDEN,\n        PAGE_LIFECYCLE_STATE_TERMINATED\n      );\n      this.sendBeacons(LIFECYCLE_PAGE);\n    }\n  }\n\n  onPageStateChange(e) {\n    const { newState, oldState } = e;\n\n    switch (newState) {\n      case PAGE_LIFECYCLE_STATE_ACTIVE:\n        this._updateDurations(oldState, newState);\n        this.sendBeacons();\n        this._touch();\n        break;\n\n      case PAGE_LIFECYCLE_STATE_PASSIVE:\n        this._updateDurations(oldState, newState);\n        this.sendBeacons();\n        break;\n\n      case PAGE_LIFECYCLE_STATE_HIDDEN:\n        this._updateDurations(oldState, newState);\n        this.sendBeacons();\n        break;\n\n      case PAGE_LIFECYCLE_STATE_TERMINATED:\n        this.onUnload();\n        break;\n    }\n  }\n\n  onScroll(e) {\n    this._touch();\n\n    const scrollDepth = getScrollDepth();\n\n    const pages = this.pending.filter(\n      (item) => item.lifecycle === LIFECYCLE_PAGE\n    );\n\n    pages.forEach((pv) => {\n      pv.meta[SCROLL_DEPTH] = Math.min(\n        1,\n        Math.max(scrollDepth, pv.meta[SCROLL_DEPTH] || 0)\n      );\n    });\n  }\n\n  /**\n   * Event handler for decorating an element with a URL (for now only\n   * anchor tags)\n   */\n  autoDecorate(elem) {\n    const xdm = this.config(KEY_CROSS_DOMAIN);\n\n    if (!xdm) return;\n\n    const domains = isString(xdm) ? [xdm] : isArray(xdm) ? xdm : [];\n\n    let canDecorate;\n\n    for (let i = 0; i < domains.length; i++) {\n      if (elem.hostname.indexOf(domains[i]) !== -1) {\n        canDecorate = true;\n        break;\n      }\n    }\n\n    if (canDecorate) {\n      const decorated = this.decorate(elem);\n\n      if (decorated) {\n        elem.href = decorated;\n        // bind an event handler on mouseup to remove the url\n      }\n    }\n  }\n\n  /**\n   * Resets cookie\n   */\n  reset() {\n    Woopra.docCookies.removeItem(\n      this.config(KEY_COOKIE_NAME),\n      this.config(KEY_COOKIE_PATH),\n      this.config(KEY_COOKIE_DOMAIN)\n    );\n    this.cookie = null;\n    this._setupCookie();\n  }\n\n  /**\n   * Decorates a given URL with a __woopraid query param with value of\n   * the current cookie\n   */\n  decorate(url) {\n    let el;\n    let query;\n    let pathname;\n    let host;\n\n    if (isString(url)) {\n      el = document.createElement('a');\n      el.href = url;\n      query = el.search ? '&' : '?';\n    } else if (url && url.href) {\n      el = url;\n    }\n\n    if (el) {\n      query = el.search ? '&' : '?';\n      pathname =\n        el.pathname && el.pathname.charAt(0) === '/'\n          ? el.pathname\n          : `/${el.pathname}`;\n\n      host =\n        el.hostname +\n        (el.port && el.port !== '' && el.port !== '80' && el.port !== '0'\n          ? `:${el.port}`\n          : '');\n\n      return `${el.protocol}//${host}${pathname}${el.search}${query}${XDM_PARAM_NAME}=${this.cookie}${el.hash}`;\n    }\n  }\n\n  /**\n   * Undecorates a URL with __woopraid query param\n   */\n  undecorate(url) {\n    const regex = new RegExp(`[?&]+(?:${XDM_PARAM_NAME})=([^&#]*)`, 'gi');\n    let _url = url;\n\n    if (url && url.href) {\n      _url = url.href;\n    }\n\n    if (_url) {\n      return _url.replace(regex, '');\n    }\n  }\n\n  getPageUrl() {\n    if (this.config(KEY_IGNORE_QUERY_URL)) {\n      return Woopra.location('pathname');\n    }\n    return `${Woopra.location('pathname')}${Woopra.location('search')}`;\n  }\n\n  getPageHash() {\n    return Woopra.location('hash');\n  }\n\n  getPageTitle() {\n    return document.getElementsByTagName('title').length === 0\n      ? ''\n      : document.getElementsByTagName('title')[0].innerHTML;\n  }\n\n  getDomainName() {\n    return Woopra.location('hostname');\n  }\n\n  getURI() {\n    return Woopra.location('href');\n  }\n\n  /**\n   * Retrieves a Woopra unique id from a URL's query param (__woopraid)\n   *\n   * @param {String} href The full URL to extract from\n   */\n  getUrlId(href = Woopra.location('href')) {\n    const matches = href.match(URL_ID_REGEX);\n\n    if (matches && matches[1]) {\n      return matches[1];\n    }\n  }\n\n  getOptionParams() {\n    // default params\n    const o = {\n      project: this.config(KEY_DOMAIN) || Woopra.getHostnameNoWww(),\n      instance: this.instanceName,\n      meta: Woopra.docCookies.getItem('wooMeta') || '',\n      screen: `${window.screen.width}x${window.screen.height}`,\n      language:\n        window.navigator.browserLanguage || window.navigator.language || '',\n      app: this.config(KEY_APP),\n      referer: document.referrer\n    };\n\n    if (!this.config(KEY_DOMAIN)) {\n      o._warn = 'no_domain';\n\n      if (Woopra.getHostnameNoWww() !== Woopra.getDomain()) {\n        o._warn += ',domain_mismatch';\n      }\n    }\n\n    // set cookie if configured\n    if (this.config(KEY_USE_COOKIES)) {\n      o.cookie = this.getCookie() || this.cookie;\n    }\n\n    // set ip if configured\n    if (this.config(KEY_IP)) {\n      o.ip = this.config(KEY_IP);\n    }\n\n    return o;\n  }\n\n  /**\n   * Stop ping timers and cleanup any globals.  Shouldn't really\n   * be needed by clients.\n   */\n  dispose() {\n    this.stopPing();\n\n    for (let id in this.__l) {\n      if (this.__l.hasOwnProperty(id)) {\n        removeHandler(id, this.instanceName);\n      }\n    }\n    this.__l = null;\n\n    // cleanup global\n    if (!isUndefined(window[this.instanceName])) {\n      try {\n        delete window[this.instanceName];\n      } catch (e) {\n        window[this.instanceName] = undefined;\n      }\n    }\n  }\n}\n","import { isFunction, isUndefined } from 'lodash-es';\nimport attachGlobalEvents from './lib/global-events';\nimport Tracker from './tracker';\nimport Woopra from './woopra';\n\nwindow.WoopraTracker = Tracker;\nwindow.WoopraLoadScript = Woopra.loadScript;\n\nattachGlobalEvents();\n\nif (!isUndefined(window.exports)) {\n  Woopra.Tracker = Tracker;\n  window.exports.Woopra = Woopra;\n\n  if (isFunction(window.woopraLoaded)) {\n    window.woopraLoaded();\n    window.woopraLoaded = null;\n  }\n}\n\n// Initialize instances & preloaded settings/events\nvar _queue = window.__woo || window._w;\nif (!isUndefined(_queue)) {\n  for (var name in _queue) {\n    if (_queue.hasOwnProperty(name)) {\n      var instance = new Tracker(name);\n      instance.init();\n\n      // DO NOT REMOVE\n      // compatibility with old tracker and chat\n      if (isUndefined(window.woopraTracker)) {\n        window.woopraTracker = instance;\n      }\n    }\n  }\n}\n"],"names":["isUndefined","value","undefined","global","Object","freeSelf","self","freeGlobal","Function","root","Symbol","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","baseGetTag","isOwn","call","tag","unmasked","e","result","getRawTag","objectToString","isObject","type","isFunction","Date","now","reWhitespace","reTrimStart","baseTrim","string","slice","index","length","test","charAt","trimmedEndIndex","replace","isObjectLike","isSymbol","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","toNumber","other","valueOf","isBinary","nativeMax","Math","max","nativeMin","min","debounce","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","arguments","this","clearTimeout","cancel","flush","XDM_PARAM_NAME","CAMPAIGN_KEYS","SECOND_LEVEL_TLDS","RANDOM_STRING_CHARS","URL_ID_REGEX","RegExp","LIFECYCLE_ACTION","LIFECYCLE_PAGE","SCROLL_DEPTH","ACTION_PV","IDPTNC","TARGET_BLANK","DATA_TRACKED_ATTRIBUTE","ACTION_PROPERTY_PREFIX","ENDPOINT_TRACK","ENDPOINT_UPDATE","PAGE_LIFECYCLE_STATE_ACTIVE","PAGE_LIFECYCLE_STATE_PASSIVE","PAGE_LIFECYCLE_STATE_HIDDEN","PAGE_LIFECYCLE_STATE_FROZEN","PAGE_LIFECYCLE_STATE_TERMINATED","EVENT_BEFOREUNLOAD","EVENT_BLUR","EVENT_CLICK","EVENT_DOWNLOAD","EVENT_FOCUS","EVENT_FREEZE","EVENT_LINK_CLICK","EVENT_MOUSEMOVE","EVENT_OUTGOING","EVENT_PAGEHIDE","EVENT_PAGESHOW","EVENT_RESUME","EVENT_SCROLL","EVENT_STATECHANGE","EVENT_UNLOAD","EVENT_VISIBILITYCHANGE","KEY_AUTO_DECORATE","KEY_BEACONS","KEY_CAMPAIGN_ONCE","KEY_CLICK_PAUSE","KEY_CONTEXT","KEY_COOKIE_DOMAIN","KEY_COOKIE_EXPIRE","KEY_COOKIE_NAME","KEY_COOKIE_PATH","KEY_CROSS_DOMAIN","KEY_DOMAIN","KEY_DOWNLOAD_EXTENSIONS","KEY_DOWNLOAD_PAUSE","KEY_DOWNLOAD_TRACKING","KEY_FORM_PAUSE","KEY_HIDE_CAMPAIGN","KEY_HIDE_XDM_DATA","KEY_IDLE_THRESHOLD","KEY_IDLE_TIMEOUT","KEY_IGNORE_QUERY_URL","KEY_MAP_QUERY_PARAMS","KEY_OUTGOING_PAUSE","KEY_OUTGOING_TRACKING","KEY_PERSONALIZATION","KEY_PING","KEY_PING_INTERVAL","KEY_PROTOCOL","KEY_SAVE_URL_HASH","KEY_THIRD_PARTY","KEY_USE_COOKIES","ACTION_PROPERTY_ALIASES","DEFAULT_DOWNLOAD_EXTENSIONS","ELEMENT_MATCHER_LINK","ELEMENT_MATCHER_CLICK","tagName","handlers","removeHandler","id","instance","addEventListener","element","callback","on","parent","event","instanceName","__l","push","fire","handler","_l","_event","i","Array","EventTargetShim","_registry","listener","opts","_getRegistry","removeEventListener","typeRegistry","handlerIndex","indexOf","splice","dispatchEvent","evt","target","freeze","forEach","StateChangeEvent","initDict","newState","oldState","originalEvent","IS_SAFARI","safari","pushNotification","SUPPORTS_PAGE_TRANSITION_EVENTS","EVENTS","onbeforeunload","preventDefault","returnValue","LEGAL_STATE_TRANSITIONS","map","arr","reduce","acc","val","idx","getCurrentState","document","visibilityState","hasFocus","state","_state","_unsavedChanges","_handleEvents","_this","bind","_safariBeforeUnloadTimeout","defaultPrevented","_dispatchChangesIfNeeded","addUnsavedChanges","removeUnsavedChanges","idIndex","path","order","oldIndex","newIndex","keys","getLegalStateTransitionPath","persisted","wasDiscarded","isArray","isString","nativeIsFinite","isFinite","randomString","s","rnum","floor","random","substring","isLeftClick","window","_isUndefined","which","button","metaKey","altKey","ctrlKey","shiftKey","getElement","selector","_options","_isString","el","querySelectorAll","getElementById","substr","getElementsByClassName","prefixObjectKeys","object","prefix","blacklist","obj","key","isBlacklisted","getScrollDepth","scrollHeight","body","scrollDepth","scrollY","innerHeight","callCallback","action","console","error","stack","matchesElement","matcher","elementTagName","toLowerCase","match","findParentElement","elem","parentNode","onClick","srcElement","globals","getAttribute","onMouseDown","onMouseMove","onScroll","_throttle","onPageStateChange","noop","WoopraAction","woopra","params","meta","update","lastArg","$action","cancelAction","baseClamp","number","lower","upper","symbolProto","symbolToString","baseToString","array","iteratee","arrayMap","INFINITY","toInteger","toFinite","remainder","hasItem","sKey","encodeURIComponent","cookie","decodeURIComponent","sValue","vEnd","sPath","sDomain","bSecure","sExpires","constructor","Number","Infinity","String","toUTCString","aKeys","split","nLen","nIdx","TYPE_BUTTON","TYPE_SUBMIT","TYPE_RESET","removeScript","script","removeChild","Woopra","getHostname","location","docCookies","property","historyReplaceState","history","replaceState","data","title","url","hideUrlParams","regex","join","href","getUrlParams","vars","m","buildUrlParams","p","getCustomData","method","getDomain","hostname","domain","lastIndexOf","getHostnameNoWww","isOutgoingLink","targetHostname","currentHostname","currentDomain","startsWith","hideCrossDomainId","mapQueryParams","mapping","redirect","link","getCampaignData","campaign","hideCampaignData","leftClick","loadScript","errorCallback","createElement","async","onreadystatechange","onload","onerror","readyState","src","appendChild","head","serializeForm","form","nodeName","exclude","elements","name","checked","j","selected","_on","_fire","attachEvent","position","endsWith","end","Tracker","visitorData","sessionData","_isFunction","navigator","sendBeacon","setDate","getDate","idle","last_activity","loaded","dirtyCookie","sentCampaign","version","pending","beaconQueue","lastAction","init","_processQueue","_setupCookie","_bindEvents","config","_wpt","__woo","_w","_e","events","url_id","getUrlId","getCookie","setItem","_this2","downloaded","onLink","l","moved","outgoing","autoDecorate","_dataSetter","dataStore","_isObject","getVisitorUrlData","identify","getItem","getProtocol","protocol","getEndpoint","Error","thirdPartyPath","visit","funcName","_push","types","endpoint","lifecycle","getOptionParams","eventName","close","timeout","rawData","original","alias","eventData","contextData","JSON","stringify","fullEventData","dirty","Boolean","useBeacon","isUnloading","retrack","beforeCallback","queue","sendBeacons","scriptUrl","track","hash","onSuccess","onBeforeSend","onError","getPageUrl","getPageTitle","getDomainName","uri","getURI","returning","getPageHash","startPing","idptnc","project","hasCancelled","item","trackForm","els","bindEl","ev","props","_this3","trackFormHandler","trackFinished","properties","personData","noSubmit","setAttribute","stopPropagation","timer","submit","trackClick","_this4","trackClickHandler","noNav","click","pingInterval","setInterval","_this5","ping","stopPing","clearInterval","_updateDurations","updateDuration","_processLifecycle","toRetrack","_this6","filter","successCallback","_drainBeaconQueue","useCookies","isEmptyBeaconParams","rest","idMap","toSend","items","_this7","_this7$lastAction","duration","round","payloads","line","Blob","size","payload","formData","FormData","append","sleep","_touch","clickTarget","text","innerText","textContent","tagname","classname","className","downloadTypes","isDownloadFileType","pathname","onUnload","pv","xdm","canDecorate","domains","_isArray","decorated","decorate","reset","removeItem","query","host","search","port","undecorate","_url","getElementsByTagName","innerHTML","matches","o","screen","width","height","language","browserLanguage","app","referer","referrer","_warn","ip","dispose","WoopraTracker","WoopraLoadScript","PageLifecycle","exports","woopraLoaded","_queue","woopraTracker"],"mappings":"yBAiBA,SAASA,EAAYC,eACFC,IAAVD,ECjBT,MAAkC,iBAAVE,QAAsBA,QAAUA,OAAOC,SAAWA,QAAUD,OCEhFE,EAA0B,iBAARC,MAAoBA,MAAQA,KAAKF,SAAWA,QAAUE,OAGjEC,GAAcF,GAAYG,SAAS,cAATA,KCHxBC,EAAKC,OCAdC,EAAcP,OAAOQ,UAGrBC,EAAiBF,EAAYE,eAO7BC,EAAuBH,EAAYI,SAGnCC,EAAiBN,EAASA,EAAOO,iBAAcf,ECfnD,IAOIY,EAPcV,OAAOQ,UAOcG,SCHvC,IAIIC,EAAiBN,EAASA,EAAOO,iBAAcf,EASnD,SAASgB,EAAWjB,UACL,MAATA,OACeC,IAAVD,EAdQ,qBADL,gBAiBJe,GAAkBA,KAAkBZ,OAAOH,GFGrD,SAAmBA,OACbkB,EAAQN,EAAeO,KAAKnB,EAAOe,GACnCK,EAAMpB,EAAMe,OAGdf,EAAMe,QAAkBd,MACpBoB,GAAW,EACf,MAAOC,QAELC,EAASV,EAAqBM,KAAKnB,UACnCqB,IACEH,EACFlB,EAAMe,GAAkBK,SAEjBpB,EAAMe,IAGVQ,EEnBHC,CAAUxB,GDNhB,SAAwBA,UACfa,EAAqBM,KAAKnB,GCM7ByB,CAAezB,GCCrB,SAAS0B,EAAS1B,OACZ2B,SAAc3B,SACF,MAATA,IAA0B,UAAR2B,GAA4B,YAARA,GCD/C,SAASC,EAAW5B,OACb0B,EAAS1B,UACL,MAILoB,EAAMH,EAAWjB,SA3BT,qBA4BLoB,GA3BI,8BA2BcA,GA7BZ,0BA6B6BA,GA1B7B,kBA0BgDA,ECf/D,MAAU,kBACDZ,EAAKqB,KAAKC,OClBfC,EAAe,KCEnB,IAAIC,EAAc,OASlB,SAASC,EAASC,UACTA,EACHA,EAAOC,MAAM,EDHnB,SAAyBD,WACnBE,EAAQF,EAAOG,OAEZD,KAAWL,EAAaO,KAAKJ,EAAOK,OAAOH,aAC3CA,ECDaI,CAAgBN,GAAU,GAAGO,QAAQT,EAAa,IAClEE,ECSN,SAASQ,EAAa1C,UACJ,MAATA,GAAiC,iBAATA,ECFjC,SAAS2C,EAAS3C,SACO,iBAATA,GACX0C,EAAa1C,IArBF,mBAqBYiB,EAAWjB,GCpBvC,IAGI4C,EAAa,qBAGbC,EAAa,aAGbC,EAAY,cAGZC,EAAeC,SAyBnB,SAASC,EAASjD,MACI,iBAATA,SACFA,KAEL2C,EAAS3C,UAzCL,OA4CJ0B,EAAS1B,GAAQ,KACfkD,EAAgC,mBAAjBlD,EAAMmD,QAAwBnD,EAAMmD,UAAYnD,EACnEA,EAAQ0B,EAASwB,GAAUA,EAAQ,GAAMA,KAEvB,iBAATlD,SACQ,IAAVA,EAAcA,GAASA,EAEhCA,EAAQiC,EAASjC,OACboD,EAAWP,EAAWP,KAAKtC,UACvBoD,GAAYN,EAAUR,KAAKtC,GAC/B+C,EAAa/C,EAAMmC,MAAM,GAAIiB,EAAW,EAAI,GAC3CR,EAAWN,KAAKtC,GAvDb,KAuD6BA,ECvDvC,IAGIqD,EAAYC,KAAKC,IACjBC,EAAYF,KAAKG,IAwDrB,SAASC,EAASC,EAAMC,EAAMC,OACxBC,EACAC,EACAC,EACAzC,EACA0C,EACAC,EACAC,EAAiB,EACjBC,GAAU,EACVC,GAAS,EACTC,GAAW,KAEI,mBAARX,QACH,IAAIY,UAzEQ,gCAmFXC,EAAWC,OACdC,EAAOZ,EACPa,EAAUZ,SAEdD,EAAWC,OAAW9D,EACtBkE,EAAiBM,EACjBlD,EAASoC,EAAKiB,MAAMD,EAASD,YAItBG,EAAYJ,UAEnBN,EAAiBM,EAEjBR,EAAUa,WAAWC,EAAcnB,GAE5BQ,EAAUI,EAAWC,GAAQlD,WAa7ByD,EAAaP,OAChBQ,EAAoBR,EAAOP,cAMNjE,IAAjBiE,GAA+Be,GAAqBrB,GACzDqB,EAAoB,GAAOZ,GANJI,EAAON,GAM8BH,WAGxDe,QACHN,EAAO3C,OACPkD,EAAaP,UACRS,EAAaT,GAGtBR,EAAUa,WAAWC,WA3BAN,OAGjBU,EAAcvB,GAFMa,EAAOP,UAIxBG,EACHb,EAAU2B,EAAanB,GAJDS,EAAON,IAK7BgB,EAoB+BC,CAAcX,aAG1CS,EAAaT,UACpBR,OAAUhE,EAINqE,GAAYR,EACPU,EAAWC,IAEpBX,EAAWC,OAAW9D,EACfsB,YAeA8D,QACHZ,EAAO3C,IACPwD,EAAaN,EAAaP,MAE9BX,EAAWyB,UACXxB,EAAWyB,KACXtB,EAAeO,EAEXa,EAAY,SACErF,IAAZgE,SACKY,EAAYX,MAEjBG,SAEFoB,aAAaxB,GACbA,EAAUa,WAAWC,EAAcnB,GAC5BY,EAAWN,eAGNjE,IAAZgE,IACFA,EAAUa,WAAWC,EAAcnB,IAE9BrC,SAvGTqC,EAAOX,EAASW,IAAS,EACrBlC,EAASmC,KACXO,IAAYP,EAAQO,QAEpBJ,GADAK,EAAS,YAAaR,GACHR,EAAUJ,EAASY,EAAQG,UAAY,EAAGJ,GAAQI,EACrEM,EAAW,aAAcT,IAAYA,EAAQS,SAAWA,GAoG1De,EAAUK,uBAnCQzF,IAAZgE,GACFwB,aAAaxB,GAEfE,EAAiB,EACjBL,EAAWI,EAAeH,EAAWE,OAAUhE,GAgCjDoF,EAAUM,6BA5BW1F,IAAZgE,EAAwB1C,EAAS2D,EAAapD,MA6BhDuD,EC3LF,MAEMO,EAAiB,aACjBC,EAAgB,CAC3B,WACA,UACA,KACA,SACA,SACA,QAEWC,EAAoB,CAC/B,SACA,SACA,SACA,QACA,SACA,QACA,SACA,SACA,QACA,QACA,SACA,QACA,UAEWC,EACX,iEAGWC,EAAe,IAAIC,OAAOL,uBAE1BM,EAAmB,SACnBC,EAAiB,OAEjBC,EAAe,eAEfC,EAAY,KAEZC,EAAS,SAETC,EAAe,SAEfC,EAAyB,eAEzBC,EAAyB,MAIzBC,EAAiB,KACjBC,EAAkB,SAGlBC,EAA8B,SAC9BC,EAA+B,UAC/BC,EAA8B,SAC9BC,EAA8B,SAC9BC,EAAkC,aAElCC,EAAqB,eACrBC,EAAa,OACbC,EAAc,QACdC,EAAiB,WACjBC,EAAc,QACdC,GAAe,SACfC,GAAmB,OAEnBC,GAAkB,YAClBC,GAAiB,WACjBC,GAAiB,WACjBC,GAAiB,WACjBC,GAAe,SACfC,GAAe,SACfC,GAAoB,cACpBC,GAAe,SACfC,GAAyB,mBAGzBC,GAAoB,gBACpBC,GAAc,UACdC,GAAoB,gBACpBC,GAAkB,cAElBC,GAAc,UACdC,GAAoB,gBACpBC,GAAoB,gBACpBC,GAAkB,cAClBC,GAAkB,cAClBC,GAAmB,eACnBC,GAAa,SACbC,GAA0B,sBAC1BC,GAAqB,iBACrBC,GAAwB,oBACxBC,GAAiB,aACjBC,GAAoB,gBACpBC,GAAoB,gBACpBC,GAAqB,iBACrBC,GAAmB,eACnBC,GAAuB,mBAEvBC,GAAuB,mBAEvBC,GAAqB,iBACrBC,GAAwB,oBACxBC,GAAsB,kBACtBC,GAAW,OACXC,GAAoB,gBACpBC,GAAe,WACfC,GAAoB,gBACpBC,GAAkB,cAClBC,GAAkB,cAWlBC,GAA0B,CACrC,CAACzD,EAAQA,GACT,CAAC,YAAa,YACd,CAAC,UAAW,UACZ,CAAC,OAAQ,OACT,CAAC,aAAc,aACf,CAAC,UAAW,UAGD0D,GAA8B,CACzC,MACA,MACA,MACA,MACA,MACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OAGWC,GAAuB,CAAC,KAExBC,GAAwB,CACnC,IACA,SACA,CAAEC,QAAS,QAASxI,KAAM,UAC1B,CAAEwI,QAAS,QAASxI,KAAM,sBC5J5B,mBACuB1B,IADvB,mBAE2B,IAF3B,2BAGmC,IAHnC,mBAI2B,KCXrBmK,GAAW,GAEV,SAASC,GAAcC,EAAIC,GAChCH,GAASE,GAAIC,GAAY,KAGpB,SAASC,GAAiBC,EAAS9I,EAAM+I,SAC1CD,GAAAA,EAASD,kBACXC,EAAQD,iBAAiB7I,EAAM+I,GAI5B,SAASC,GAAGC,EAAQC,EAAOH,OAC1BJ,EAAKM,EAAOE,aAEbV,GAASS,KACZT,GAASS,GAAS,IAEpBT,GAASS,GAAOP,GAAMM,EAElBA,EAAOG,MACJH,EAAOG,IAAIF,KACdD,EAAOG,IAAIF,GAAS,IAEtBD,EAAOG,IAAIF,GAAOG,KAAKN,IAIpB,SAASO,GAAKJ,OACfK,EAEAC,EADEC,EAAShB,GAASS,MAGpBO,MACG,IAAId,KAAMc,KACTA,EAAOxK,eAAe0J,KAExBa,GADAD,EAAUE,EAAOd,KACDY,EAAQH,MACdI,EAAGN,OACN,IAAIQ,EAAI,EAAGA,EAAIF,EAAGN,GAAOxI,OAAQgJ,IACpCF,EAAGN,GAAOQ,GAAGzG,MAAMY,KAAM8F,MAAM3K,UAAUwB,MAAMhB,KAAKoE,UAAW,2mDCFrEgG,gCAKGC,UAAY,8BAUnBhB,iBAAA,SAAiB7I,EAAM8J,EAAUC,QAC1BC,aAAahK,GAAMqJ,KAAKS,MAU/BG,oBAAA,SAAoBjK,EAAM8J,EAAUC,OAC5BG,EAAerG,KAAKmG,aAAahK,GACjCmK,EAAeD,EAAaE,QAAQN,GACtCK,GAAgB,GAClBD,EAAaG,OAAOF,EAAc,MAStCG,cAAA,SAAcC,UAEZA,EAAIC,OAAS3G,KACbrF,OAAOiM,OAAOF,QAETP,aAAaO,EAAIvK,MAAM0K,SAAQ,SAACZ,UAAaA,EAASS,OACpD,KAUTP,aAAA,SAAahK,UACH6D,KAAKgG,UAAU7J,GAAQ6D,KAAKgG,UAAU7J,IAAS,SAIrD2K,GACJ,SAAY3K,EAAM4K,QACX5K,KAAOA,OACP6K,SAAWD,EAASC,cACpBC,SAAWF,EAASE,cACpBC,cAAgBH,EAASG,eAK5BC,GAA8B,iBAAXC,QAAuBA,OAAOC,iBAEjDC,GAAkC,eAAgBzM,KAElD0M,GAAS,CACb1F,EACAH,EACAc,GACAV,GACAM,GACAD,GAIAmF,GAAkCpF,GAAiBK,IAO/CiF,GAAiB,SAACd,UACtBA,EAAIe,iBACIf,EAAIgB,YAAc,iBAkBtBC,GAA0B,CAE9B,CACEvG,EACAC,EACAC,EACAE,GAKF,CACEJ,EACAC,EACAC,EACAC,GAIF,CACED,EACAD,EACAD,GAIF,CAACG,EAA6BD,GAI9B,CAACC,EAA6BH,GAC9B,CAACG,EAA6BF,IAC9BuG,KAzCsB,SAACC,UACvBA,EAAIC,QAAO,SAACC,EAAKC,EAAKC,UACpBF,EAAIC,GAAOC,EACJF,IACN,OA0ECG,GAAkB,kBAClBC,SAASC,kBAAoB9G,EACxBA,EAEL6G,SAASE,WACJjH,EAEFC,MA2KM,oEA7JLiH,EAAQJ,cAETK,OAASD,IACTE,gBAAkB,KAGlBC,cAAgBC,EAAKD,cAAcE,mIAGxCpB,GAAOV,SAAQ,SAACH,UAAQ1B,iBAAiB0B,EAAKgC,EAAKD,eAAe,MAS9DtB,IACFnC,iBAAiBvD,GAAoB,SAACiF,KAC/BkC,2BAA6BtJ,YAAW,WACrCoH,EAAImC,kBAAoBnC,EAAIgB,YAAY7K,OAAS,KAChDiM,yBAAyBpC,EAAKpF,KAEpC,0HA0BTyH,kBAAA,SAAkBjE,IAGX9E,KAAKwI,gBAAgBjC,QAAQzB,IAAO,IAGH,IAAhC9E,KAAKwI,gBAAgB3L,QACvBmI,iBAAiBvD,EAAoB+F,SAElCgB,gBAAgBhD,KAAKV,OAQ9BkE,qBAAA,SAAqBlE,OACbmE,EAAUjJ,KAAKwI,gBAAgBjC,QAAQzB,GAEzCmE,GAAW,SACRT,gBAAgBhC,OAAOyC,EAAS,GAGD,IAAhCjJ,KAAKwI,gBAAgB3L,QACvBuJ,oBAAoB3E,EAAoB+F,QAU9CsB,yBAAA,SAAyB5B,EAAeF,MAClCA,IAAahH,KAAKuI,eAEdW,EAvIwB,SAACjC,EAAUD,OAGxC,IAAImC,EAAOtD,EAAI,EAAIsD,EAAQxB,GAAwB9B,KAAOA,EAAG,KAC1DuD,EAAWD,EAAMlC,GACjBoC,EAAWF,EAAMnC,MAEnBoC,GAAY,GAAKC,GAAY,GAAKA,EAAWD,SAGxCzO,OAAO2O,KAAKH,GAAOxM,MAAMyM,EAAUC,EAAW,SAGlD,GA0HUE,CADIvJ,KAAKuI,OAC6BvB,GAE1CnB,EAAI,EAAGA,EAAIqD,EAAKrM,OAAS,IAAKgJ,EAAG,KAClCoB,EAAWiC,EAAKrD,GAChBmB,EAAWkC,EAAKrD,EAAI,QAErB0C,OAASvB,OACTP,cACH,IAAIK,GAAiB,cAAe,CAClCG,SAAAA,EACAD,SAAAA,EACAE,cAAAA,SAWVuB,cAAA,SAAc/B,UACRS,IACFlH,aAAaD,KAAK4I,4BAGZlC,EAAIvK,WACLgG,QACAC,QACE0G,yBAAyBpC,EAAKwB,iBAEhCrG,OACEiH,yBAAyBpC,EAAKtF,cAEhCM,EAGC1B,KAAKuI,SAAWnH,QACb0H,yBAAyBpC,EAAKwB,iBAGlChG,QACAK,QACEuG,yBACHpC,EACAA,EAAI8C,UACAjI,EACAC,cAGHgB,GAKDxC,KAAKuI,SAAWhH,GAChBvB,KAAKuI,SAAW/G,QAEXsH,yBAAyBpC,EAAKwB,iBAGlCpG,QACEgH,yBAAyBpC,EAAKnF,8BAvHzC,kBACSvB,KAAKuI,qCASd,kBACSJ,SAASsB,eAAgB,uCAnDR1D,QChNdD,MAAM4D,QCCpB,SAASC,GAASnP,SACO,iBAATA,IACVkP,GAAQlP,IAAU0C,EAAa1C,IArBrB,mBAqB+BiB,EAAWjB,GCvB1D,IAAIoP,GAAiB5O,EAAK6O,SCKnB,SAASC,aACVC,EAAI,GAEClE,EAAI,EAAGA,EAAI,GAAIA,IAAK,KACrBmE,EAAOlM,KAAKmM,MAAMnM,KAAKoM,SAAW3J,EAAoB1D,QAC5DkN,GAAKxJ,EAAoB4J,UAAUH,EAAMA,EAAO,UAG3CD,EAGF,SAASK,GAAY1D,mBAAAA,IAAAA,EAAM2D,OAAOhF,SAEnCiF,EAAY5D,EAAI6D,QAAwB,IAAd7D,EAAI6D,QAC9BD,EAAY5D,EAAI8D,SAA0B,IAAf9D,EAAI8D,UACjB9D,EAAI+D,UAAY/D,EAAIgE,SAAWhE,EAAIiE,UAAYjE,EAAIkE,SAShE,SAASC,GAAWC,EAAUzM,OAC7B0M,EAAWC,GAASF,GAAYzM,GAAW,GAAKyM,GAAY,MAE9DC,EAASE,UACJF,EAASE,GACX,GAAID,GAASF,GAAW,IACzB3C,SAAS+C,wBACJ/C,SAAS+C,iBAAiBJ,GAC5B,GAAoB,MAAhBA,EAAS,UACX3C,SAASgD,eAAeL,EAASM,OAAO,IAC1C,GAAoB,MAAhBN,EAAS,UACX3C,SAASkD,uBAAuBP,EAASM,OAAO,KAKtD,SAASE,GAAiBC,EAAQC,EAAQC,OACzCC,EAAM,MAERpB,EAAYiB,GAAS,OAAOG,MAE3B,IAAIC,KAAOJ,KACVA,EAAOnQ,eAAeuQ,GAAM,SACxBnR,EAAQ+Q,EAAOI,GAEjBC,GAAgB,EAEX/F,EAAI,EAAGA,EAAI4F,EAAU5O,OAAQgJ,OAChC4F,EAAU5F,GAAG,KAAO8F,EAAK,CAC3BC,GAAgB,QAMjBA,GACS,cAAVpR,GACU,SAAVA,GACC8P,EAAY9P,KAEbkR,KAAOF,EAASG,GAASnR,UAKxBkR,EAGF,SAASG,SDjDErR,ECkDVsR,EAAe3D,SAAS4D,KAAKD,aAE7BE,IACF3B,OAAO4B,SAAW,GAAK5B,OAAO6B,aAAeJ,SAE1ChO,KAAKC,IAAI,EAAGD,KAAKG,IAAI,EDtDL,iBADPzD,ECuDwBwR,IDtDLpC,GAAepP,GCsDKwR,EAAc,IAGhE,SAASG,GAAajH,EAAUkH,OAEnClH,IACA,MAAOpJ,GACPuQ,QAAQC,yBAAyBF,eACjCC,QAAQC,MAAMxQ,EAAEyQ,QAIpB,SAASC,GAAevH,EAASwH,WACzBC,EAAiBzH,EAAQN,QAAQgI,cAE9B9G,EAAI,EAAGA,EAAI4G,EAAQ5P,OAAQgJ,IAAK,OACjC+G,EAAQH,EAAQ5G,MAGlB6G,oBAFaE,SAAAA,EAAOjI,WAAWiI,GAAOD,gBAItC3B,GAAS4B,WAAUA,SAAAA,EAAOzQ,QAAS8I,EAAQ9I,MAAM,OAAO,SAGvD,EAGF,SAAS0Q,GAAkB5H,EAASwH,WACrCK,EAAO7H,IAEHqF,EAAYwC,IAAkB,OAATA,GACvBA,EAAKnI,SAAW6H,GAAeM,EAAML,KAEzCK,EAAOA,EAAKC,kBAGPD,ECvGT,SAASE,GAAQlR,OACXgR,EAAOhR,EAAEmR,YAAcnR,EAAE6K,OAEzByD,GAAYtO,IACd2J,GAAK9D,EAAa7F,EAAGgR,IAGnBI,GAAO,mBAA2BA,GAAO,qBAIxC5C,EAHHwC,EAAOD,GAAkB/Q,EAAEmR,YAAcnR,EAAE6K,OAAQlC,MAIxC,OAATqI,GACCA,EAAKK,aAAanM,IAEnByE,GAAK1D,GAAkBjG,EAAGgR,IAKhC,SAASM,GAAYtR,OACfgR,EAEJrH,GAAKzD,GAAiBlG,EAAGO,KAAKC,OAE1B4Q,GAAO,gBAGJ5C,EAFLwC,EAAOD,GAAkB/Q,EAAEmR,YAAcnR,EAAE6K,OAAQlC,MAEhB,OAATqI,GACxBrH,GAAKhD,GAAmBqK,IAK9B,SAASO,GAAYvR,GACnB2J,GAAKzD,GAAiBlG,EAAGO,KAAKC,OAGhC,IAAMgR,GCPN,SAAkBnP,EAAMC,EAAMC,OACxBO,GAAU,EACVE,GAAW,KAEI,mBAARX,QACH,IAAIY,UAnDQ,8BAqDhB7C,EAASmC,KACXO,EAAU,YAAaP,IAAYA,EAAQO,QAAUA,EACrDE,EAAW,aAAcT,IAAYA,EAAQS,SAAWA,GAEnDZ,EAASC,EAAMC,EAAM,SACfQ,UACAR,WACCU,IDPCyO,EAAS,SAAkBzR,GAC1C2J,GAAKpD,GAAcvG,KAClB,KAEH,SAAS0R,GAAkB1R,GACzB2J,GAAKnD,GAAmBxG,GElD1B,SAAS2R,UCZYC,yBACPC,EAAQ7I,EAAI8I,EAAQC,QACzBF,OAASA,OACT7I,GAAKA,OACL8I,OAASA,OACTC,KAAOA,6BAGdC,OAAA,SAAOzP,EAAc0P,YAAd1P,IAAAA,EAAU,IACXA,EAAQgH,OAAShH,EAAQgH,QAAUrF,KAAK4N,OAAOvI,aAC5CuI,OAAOvI,MAAQhH,EAAQgH,YAGzBsI,OAAOG,OACV9N,KAAK8E,SACAzG,GAAS2P,QAAShO,KAAK4N,OAAOvI,QACnC0I,MAIJ7N,OAAA,gBACOyN,OAAOM,aAAajO,KAAK8E,UCZlC,SAASoJ,GAAUC,EAAQC,EAAOC,UAC5BF,GAAWA,SACC1T,IAAV4T,IACFF,EAASA,GAAUE,EAAQF,EAASE,QAExB5T,IAAV2T,IACFD,EAASA,GAAUC,EAAQD,EAASC,IAGjCD,ECZT,IAGIG,GAAcrT,EAASA,EAAOE,eAAYV,EAC1C8T,GAAiBD,GAAcA,GAAYhT,cAAWb,EAU1D,SAAS+T,GAAahU,MAEA,iBAATA,SACFA,KAELkP,GAAQlP,UChBd,SAAkBiU,EAAOC,WACnB9R,GAAS,EACTC,EAAkB,MAAT4R,EAAgB,EAAIA,EAAM5R,OACnCd,EAAS+J,MAAMjJ,KAEVD,EAAQC,GACfd,EAAOa,GAAS8R,EAASD,EAAM7R,GAAQA,EAAO6R,UAEzC1S,EDUE4S,CAASnU,EAAOgU,IAAgB,MAErCrR,EAAS3C,UACJ+T,GAAiBA,GAAe5S,KAAKnB,GAAS,OAEnDuB,EAAUvB,EAAQ,SACJ,KAAVuB,GAAkB,EAAIvB,IA3BjB,SA2BwC,KAAOuB,EE9B9D,IAAI6S,GAAW,EAAA,ECyBf,SAASC,GAAUrU,OACbuB,EDAN,SAAkBvB,UACXA,GAGLA,EAAQiD,EAASjD,MACHoU,IAAYpU,KAAU,EAAA,EA9BpB,uBA+BFA,EAAQ,GAAK,EAAI,GAGxBA,GAAUA,EAAQA,EAAQ,EAPd,IAAVA,EAAcA,EAAQ,ECFlBsU,CAAStU,GAClBuU,EAAYhT,EAAS,SAElBA,GAAWA,EAAUgT,EAAYhT,EAASgT,EAAYhT,EAAU,ECTzE,SAAST,GAASd,UACA,MAATA,EAAgB,GAAKgU,GAAahU,GC8DpC,SAASwU,GAAQC,WACjBA,GAGE,IAAIxO,OACT,cACEyO,mBAAmBD,GAAMhS,QAAQ,cAAe,QAChD,WACFH,KAAKqL,SAASgH,qDAtEX,SAAiBF,UACjBA,GAIHG,mBACEjH,SAASgH,OAAOlS,QACd,IAAIwD,OACF,mBACEyO,mBAAmBD,GAAMhS,QAAQ,cAAe,QAChD,+BAEJ,QAVG,cAgBJ,SAAiBgS,EAAMI,EAAQC,EAAMC,EAAOC,EAASC,OACrDR,GAAQ,6CAA6CnS,KAAKmS,UACtD,MAELS,EAAW,MACXJ,SACMA,EAAKK,kBACNC,OACHF,EACEJ,IAASO,EAAAA,EACL,0CACA,aAAeP,aAElBQ,OACHJ,EAAW,aAAeJ,aAEvBjT,KACHqT,EAAW,aAAeJ,EAAKS,qBAIrC5H,SAASgH,OACPD,mBAAmBD,GACnB,IACAC,mBAAmBG,GACnBK,GACCF,EAAU,YAAcA,EAAU,KAClCD,EAAQ,UAAYA,EAAQ,KAC5BE,EAAU,WAAa,KACnB,cAGF,SAAoBR,EAAMM,EAAOC,WACjCR,GAAQC,KAGb9G,SAASgH,OACPD,mBAAmBD,GACnB,4CACCO,EAAU,YAAcA,EAAU,KAClCD,EAAQ,UAAYA,EAAQ,KACxB,oBAcF,mBACCS,EAAQ7H,SAASgH,OACpBlS,QAAQ,0DAA2D,IACnEgT,MAAM,uBACAC,EAAOF,EAAMnT,OAAQsT,EAAO,EAAGA,EAAOD,EAAMC,IACnDH,EAAMG,GAAQf,mBAAmBY,EAAMG,WAElCH,KCxGHI,GAAc,SACdC,GAAc,SACdC,GAAa,QCAZ,SAASC,GAAaC,GACvBA,GAAUA,EAAOzD,YACnByD,EAAOzD,WAAW0D,YAAYD,GCUlC,IAAME,GAAS,GAkBf,SAASC,YACAD,GAAOE,SAAS,YAjBzBF,GAAOG,WAAaA,GAKpBH,GAAOE,SAAW,SAAkBE,EAAUtW,OAEvC8P,EAAYD,OAAOuG,SAASE,IAAY,IACtCxG,EAAY9P,UAGR6P,OAAOuG,SAASE,GAFvBzG,OAAOuG,SAASE,GAAYtW,IAclCkW,GAAOK,oBACL1G,OAAO2G,SAAW3G,OAAO2G,QAAQC,aAC7B,SAA6BC,EAAMC,EAAOC,UACjC/G,OAAO2G,QAAQC,aAAaC,EAAMC,EAAOC,IAElD,aAQNV,GAAOW,cAAgB,SAAuBzD,OACtC0D,EAAQ,IAAI7Q,mBACJmN,EAAO2D,KAAK,yBACxB,MAEIC,EAAOd,GAAOE,SAAS,QAAQ3T,QAAQqU,EAAO,WAEpDZ,GAAOK,oBAAoB,KAAM,KAAMS,GAEhCA,GAQTd,GAAOe,aAAe,eACdC,EAAO,GACPF,EAAOd,GAAOE,SAAS,eAEzBY,GACFA,EAAKvU,QAAQ,2BAA2B,SAAU0U,EAAGhG,EAAKnR,GACxDkX,EAAK/F,GAAOyD,mBAAmB5U,EAAMyV,MAAM,KAAKsB,KAAK,SAIlDG,GAGThB,GAAOkB,eAAiB,SAAwBhE,EAAQpC,YAAAA,IAAAA,EAAS,QACzDqG,EAAI,MAENvH,EAAYsD,UACPA,MAGJ,IAAIjC,KAAOiC,EACVA,EAAOxS,eAAeuQ,KAEN,cAAhBiC,EAAOjC,IACS,SAAhBiC,EAAOjC,IACNrB,EAAYsD,EAAOjC,KAEpBkG,EAAErM,QACGgG,EAAS0D,mBAAmBvD,OAAQuD,mBACrCtB,EAAOjC,aAMVkG,EAAEN,KAAK,MAShBb,GAAOoB,cAAgB,SAAuBC,EAAQvG,YAAAA,IAAAA,EAAS,WACvDkG,EAAOhB,GAAOe,mBAEf,IAAI5L,KAAK6L,KACRA,EAAKtW,eAAeyK,GAAI,KACpBrL,EAAQkX,EAAK7L,MAEfA,EAAEsE,UAAU,EAAGqB,EAAO3O,UAAY2O,EAAQ,KACtCG,EAAM9F,EAAEsE,UAAUqB,EAAO3O,QAC/BkV,EAAOpW,KAAKqE,KAAM2L,EAAKnR,MAY/BkW,GAAOsB,UAAY,SAAmBC,YAAAA,IAAAA,EAAWtB,UACzCuB,EAASD,EAAS9H,UACtB8H,EAASE,YAAY,IAAKF,EAASE,YAAY,KAAO,GAAK,UAIlB,IAAvC7R,EAAkBiG,QAAQ2L,GACrBD,EAAS9H,UACd8H,EAASE,YAAY,IAAKF,EAAS1L,QAAQ2L,GAAU,GAAK,GAIvDA,GAMTxB,GAAO0B,iBAAmB,eAClBH,EAAWtB,YAEgB,IAA7BsB,EAAS1L,QAAQ,QACZ0L,EAAShV,QAAQ,OAAQ,IAG3BgV,GAMTvB,GAAO2B,eAAiB,SAAwBC,OACxCC,EAAkB5B,KAClB6B,EAAgB9B,GAAOsB,UAAUO,WAGrCD,IAAmBC,GACnBD,EAAerV,QAAQ,SAAU,MAC/BsV,EAAgBtV,QAAQ,SAAU,KAClCiQ,GAAO,2BACPsF,IAAkB9B,GAAOsB,UAAUM,IACpC5B,GAAO+B,WAAWH,EAAgB,eAChB,KAAnBA,GACmB,MAAnBA,IAIJ5B,GAAOgC,kBAAoB,kBAClBhC,GAAOW,cAAc,CAACjR,KAG/BsQ,GAAOiC,eAAiB,SAAwBC,OACxClB,EAAOhB,GAAOe,eACd7D,EAAS,OAEV,IAAIjC,KAAOiH,EAAS,KACjBpY,EAAQkX,EAAK/F,GACdrB,EAAY9P,KACfoT,EAAOgF,EAAQjH,IAAQnR,UAIpBoT,GAGT8C,GAAOmC,SAAW,SAAkBC,GAClCpC,GAAOE,SAAS,OAAQkC,IAS1BpC,GAAOqC,gBAAkB,mBACjBrB,EAAOhB,GAAOe,eACduB,EAAW,GAERnN,EAAI,EAAGA,EAAIxF,EAAcxD,OAAQgJ,IAAK,KACvC8F,EAAMtL,EAAcwF,GACpBrL,EAAQkX,SAAY/F,IAAU+F,SAAY/F,GAE3CrB,EAAY9P,KACfwY,eAA6B,aAARrH,EAAqB,OAASA,IAASnR,UAIzDwY,GAOTtC,GAAOuC,iBAAmB,kBACjBvC,GAAOW,cAAc,CAAC,MAAO,OAAQ,UAG9CX,GAAOwC,UAAY9I,GACnBsG,GAAO5G,aAAeA,GACtB4G,GAAO7F,WAAaA,GACpB6F,GAAOyC,WDjOA,SAAoB/B,EAAKlM,EAAiBkO,YAAjBlO,IAAAA,eAAiBkO,IAAAA,UACzC5C,EAASrI,SAASkL,cAAc,UAEtC7C,EAAOrU,KAAO,kBACdqU,EAAO8C,OAAQ,EAEVhJ,EAAYkG,EAAO+C,qBAQtB/C,EAAOgD,OAAS,WACdtO,IACAqL,GAAaC,IAEfA,EAAOiD,QAAU,SAAC3X,GAChBsX,EAActX,GACdyU,GAAaC,KAbfA,EAAO+C,mBAAqB,WAVL,IAACG,GACX,KADWA,EAWC1T,KAAK0T,aAVG,aAAfA,GAA4C,WAAfA,KAW3CxO,IACAqL,GAAaC,KAcnBA,EAAOmD,IAAMvC,EAETjJ,SAAS4D,KAAM5D,SAAS4D,KAAK6H,YAAYpD,GACxCrI,SAAS0L,KAAKD,YAAYpD,ICuMjCE,GAAOH,aAAeA,GACtBG,GAAOoD,cFxOA,SAAuBC,EAAM1V,eAAAA,IAAAA,EAAU,IACvC0V,GAA0B,SAAlBA,EAAKC,kBAIZC,EAAU5V,EAAQ4V,SAAW,GAC7B/C,EAAO,GAEJrL,EAAIkO,EAAKG,SAASrX,OAAS,EAAGgJ,GAAK,EAAGA,GAAQ,OAEzB,KAA1BkO,EAAKG,SAASrO,GAAGsO,MACjBF,EAAQ1N,QAAQwN,EAAKG,SAASrO,GAAGsO,OAAS,UAIpCJ,EAAKG,SAASrO,GAAGmO,cAClB,eACKD,EAAKG,SAASrO,GAAG1J,UAClB,WACA,cACAiU,QACAE,QACAD,GACHa,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGrL,gBAE5C,eACA,QACCuZ,EAAKG,SAASrO,GAAGuO,UACnBlD,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGrL,iBAOlD,WACH0W,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGrL,gBAE5C,gBACKuZ,EAAKG,SAASrO,GAAG1J,UAClB,aACH+U,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGrL,gBAE5C,sBAED,IAAI6Z,EAAIN,EAAKG,SAASrO,GAAGxH,QAAQxB,OAAS,EAC1CwX,GAAK,EACLA,GAAQ,EAEJN,EAAKG,SAASrO,GAAGxH,QAAQgW,GAAGC,WAC9BpD,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGxH,QAAQgW,GAAG7Z,iBAM/D,gBACKuZ,EAAKG,SAASrO,GAAG1J,WAClBmU,QACAD,QACAD,GACHc,EAAK6C,EAAKG,SAASrO,GAAGsO,MAAQJ,EAAKG,SAASrO,GAAGrL,cAMlD0W,IEsKTR,GAAO6D,IAAMpP,GACbuL,GAAO8D,MAAQ/O,GACfiL,GAAO+D,YAAczP,GACrB0L,GAAO+B,WCtNP,SAAoB/V,EAAQiK,EAAQ+N,UAClChY,EAASpB,GAASoB,GAClBgY,EAAuB,MAAZA,EACP,EACAxG,GAAUW,GAAU6F,GAAW,EAAGhY,EAAOG,QAE7C8J,EAAS6H,GAAa7H,GACfjK,EAAOC,MAAM+X,EAAUA,EAAW/N,EAAO9J,SAAW8J,GDgN7D+J,GAAOiE,SEvNP,SAAkBjY,EAAQiK,EAAQ+N,GAChChY,EAASpB,GAASoB,GAClBiK,EAAS6H,GAAa7H,OAElB9J,EAASH,EAAOG,OAKhB+X,EAJJF,OAAwBja,IAAbia,EACP7X,EACAqR,GAAUW,GAAU6F,GAAW,EAAG7X,UAGtC6X,GAAY/N,EAAO9J,SACA,GAAKH,EAAOC,MAAM+X,EAAUE,IAAQjO,GC4DzD,IAAMlB,GAAOiL,GAAO8D,MAECK,yBACPvP,cACLwP,YAAc,QACdC,YAAc,QAEd1W,gBAAL,IACa,cADb,QjBoBK2W,EAAWC,UAAUC,ciBpB1B,eAGuB,IAHvB,kBAI2BxE,GAAO0B,qBAJlC,cAKuB,IAAI/V,MACvB,IAAIA,MAAO8Y,SAAQ,IAAI9Y,MAAO+Y,UAAY,QAN9C,YAQqB,eARrB,YASqB,MATrB,cAUsB,IAVtB,oBAW6B5Q,KAX7B,eAYwB,MAZxB,mBAa2B,IAb3B,eAcuB,IAdvB,eAeuB,IAfvB,eAgBwB,MAhBxB,aAiBsB,MAjBtB,kBAkB0B,IAlB1B,iBAmB0B,KAnB1B,2BAoBmC,IApBnC,eAqBwB,MArBxB,mBAsB2B,IAtB3B,iBAuByB,IAvBzB,cAwBuB,OAxBvB,MAyBc,IAzBd,SA0BkB,UA1BlB,eA2BuB,IA3BvB,aA4BqB,IA5BrB,YA6BqB,MA7BrB,WA8BoB,MA9BpB,aA+BqB,UAGhBc,aAAeA,GAAgB,cAC/B+P,KAAO,OACPlG,OAAS,QACTmG,cAAgBjZ,KAAKC,WACrBiZ,QAAS,OACTC,aAAc,OACdC,cAAe,OACfC,QxBnJc,QwBoJdC,QAAU,QACVC,YAAc,QACdC,WAAa,KAEdvQ,GAAiC,KAAjBA,IAClB+E,OAAO/E,GAAgBtF,iCAI3B8V,KAAA,2BACOvQ,IAAM,QACNwQ,cAAc,eACdC,oBACAC,cAIL3W,YAAW,kBAAMoJ,EAAKqN,kBAAiB,QAElCR,QAAS,MAERrQ,EAAWlF,KAAKkW,OAAO,eAEzBlB,EAAW9P,IACbA,EAASlF,KAAKsF,cAKZtF,KAAKkW,OAAOzS,KACdiN,GAAOgC,uBAQXqD,cAAA,SAAc5Z,OACRga,EAAO9L,OAAO+L,MAAQ/L,OAAO+L,MAAMpW,KAAKsF,cAAgB6Q,MAC5DA,EAAO9L,OAAOgM,GAAKhM,OAAOgM,GAAGrW,KAAKsF,cAAgB6Q,IAKtCA,EAAKG,WACTC,EAASJ,EAAKG,GACXzQ,EAAI,EAAGA,EAAI0Q,EAAO1Z,OAAQgJ,IAAK,KAChCuG,EAASmK,EAAO1Q,GAEnByE,EAAY8B,KACbpM,KAAKoM,EAAO,MACX9B,EAAYnO,IAASA,IAASiQ,EAAO,SAEjCA,EAAO,IAAIhN,MAAMY,KAAM8F,MAAM3K,UAAUwB,MAAMhB,KAAKyQ,EAAQ,QASvE4J,aAAA,eACQQ,EAASxW,KAAKyW,gBAEftH,OAASnP,KAAK0W,YAGfF,SACGrH,OAASqH,KAIXxW,KAAKmP,QAAUnP,KAAKmP,OAAOtS,OAAS,UAClCsS,OAASrF,MAGhB4G,GAAOG,WAAW8F,QAChB3W,KAAKkW,OAAOlT,IACZhD,KAAKmP,OACLnP,KAAKkW,OAAOnT,IACZ/C,KAAKkW,OAAOjT,IACZjD,KAAKkW,OAAOpT,UAGT0S,aAAc,KAMrBS,YAAA,sBACE9Q,GAAGnF,KAAM2B,GAAa,SAAC7F,UAAM8a,EAAK5J,QAAQlR,MAC1CqJ,GAAGnF,KAAM4B,GAAgB,SAACwP,UAAQwF,EAAKC,WAAWzF,MAClDjM,GAAGnF,KAAM+B,IAAkB,SAACjG,EAAGgX,UAAS8D,EAAKE,OAAOhb,EAAGgX,MACvD3N,GAAGnF,KAAMgC,IAAiB,SAAClG,EAAGib,UAAMH,EAAKI,MAAMlb,EAAGib,MAClD5R,GAAGnF,KAAMiC,IAAgB,SAACmP,UAAQwF,EAAKK,SAAS7F,MAChDjM,GAAGnF,KAAMqC,IAAc,SAACyK,UAAS8J,EAAKtJ,SAASR,MAC/C3H,GAAGnF,KAAMsC,IAAmB,SAACxG,UAAM8a,EAAKpJ,kBAAkB1R,MAC1DqJ,GAAGnF,KAAMyC,IAAmB,SAACqK,UAAS8J,EAAKM,aAAapK,SAW1DqK,YAAA,SAAYC,EAAWzL,EAAKnR,MACtB8P,EAAYqB,UACPyL,KAGL9M,EAAY9P,GAAQ,IAClBwQ,GAASW,UACJyL,EAAUzL,MAEf0L,EAAS1L,OACN,IAAI9F,KAAK8F,EACRA,EAAIvQ,eAAeyK,KACjB6K,GAAO+B,WAAW5M,EAAG,kBAClB2P,aAAc,GAErB4B,EAAUvR,GAAK8F,EAAI9F,SAKrB6K,GAAO+B,WAAW9G,EAAK,kBACpB6J,aAAc,GAErB4B,EAAUzL,GAAOnR,SAGZwF,QAGTsX,kBAAA,WACE5G,GAAOoB,cAAcnW,KAAKqE,KAAMA,KAAKuX,SAAU,UAMjDb,UAAA,kBACShG,GAAOG,WAAW2G,QAAQxX,KAAKkW,OAAOlT,QAG/CyU,YAAA,eACQC,EAAW1X,KAAKkW,OAAO/R,WACtBuT,GAAyB,KAAbA,EAAqBA,MAAc,MAOxDC,YAAA,SAAYzO,YAAAA,IAAAA,EAAO,QACXwO,EAAW1X,KAAKyX,iBAElBzX,KAAKkW,OAAO7R,MAAqBrE,KAAKkW,OAAO/S,UACzC,IAAIyU,MAAM,mCAGdC,EAAiB7X,KAAKkW,OAAO7R,UACvBrE,KAAKkW,OAAO/S,IAClB,UAEA+F,IAASwH,GAAOiE,SAASzL,EAAM,OACjCA,GAAQ,KAGN2O,IAAmBnH,GAAO+B,WAAWvJ,EAAM,OAC7C2O,GAAkB,KAGVH,EAAAA,0BAAwBG,EAAiB3O,KAMrDgN,OAAA,SAAOvK,EAAKnR,OACJ0W,EAAOlR,KAAKmX,YAAYnX,KAAK3B,QAASsN,EAAKnR,UAG7C0W,IAASlR,YAEN3B,QAAL,cAAkCP,KAAKC,IxBvTZ,IwByTzBD,KAAKG,IAAI+B,KAAK3B,QAAL,cxBxTgB,MwB6T3B6O,GAAO,kBAA0BlN,KAAK3B,QAAL,kBACjC6O,GAAO,kBAA0BlN,KAAK3B,QAAL,kBACjC6O,GAAO,cACL5C,EAAY4C,GAAO,gBACnBlN,KAAK3B,QAAL,aACI2B,KAAK3B,QAAL,aACA6O,GAAO,cACbA,GAAO,0BACLlN,KAAK3B,QAAL,0BAEE2B,KAAKwV,aAAexV,KAAKuV,aACtBS,gBAIF9E,KAOT4G,MAAA,SAAMnM,EAAKnR,UACFwF,KAAKmX,YAAYnX,KAAK+U,YAAapJ,EAAKnR,MAMjD+c,SAAA,SAAS5L,EAAKnR,UACLwF,KAAKmX,YAAYnX,KAAK8U,YAAanJ,EAAKnR,MAMjDmB,KAAA,SAAKoc,GACC/C,EAAWhV,KAAK+X,UACbA,GAAU3Y,MAAMY,KAAM8F,MAAM3K,UAAUwB,MAAMhB,KAAKoE,UAAW,OAOrEiY,MAAA,SAAM3Z,kBAAAA,IAAAA,EAAU,QACR4Z,EAAQ,CACZ,CAAC,cxB1VgC,OwB2VjC,CAAC,YAAahX,GACd,CAAC,cxB7V8B,QwBgW7BiQ,EAAO,GAELgH,EAAWlY,KAAK2X,YAAYtZ,EAAQ6Z,UACpCC,EAAY9Z,EAAQ8Z,WAAazX,OAGlC4W,oBAEDtX,KAAKkW,OAAO1S,KACdkN,GAAOuC,wBAIJkE,YAAYjG,EAAMlR,KAAKoY,mBAGxB/Z,EAAQga,YACVnH,EAAK7L,MAAQhH,EAAQga,WAIlBrY,KAAKkW,OAAOlS,MACfkN,EAAKoH,OAAQ,GAGfpH,EAAKqH,QAAUjO,EAAYjM,EAAQka,SAC/BvY,KAAKkW,OAAOvS,IACZtF,EAAQka,kBAENC,EAAU,QAEgBjU,mBAAyB,eAA7CkU,OAAUC,OAChBra,EAAQsa,WAAata,EAAQsa,UAAUF,KACzCD,EAAQE,GAASra,EAAQsa,UAAUF,SAIlCtB,YAAYjG,EAAMsH,OAElB,IAAI3S,EAAI,EAAGA,EAAIoS,EAAMpb,OAAQgJ,IAAK,OACfoS,EAAMpS,GAArB8F,OAAKH,YAEP2L,YACHjG,EACA5F,GACEjN,EAAQsN,GACRH,EACAA,IAAWvK,EAAyBsD,GAA0B,QAKhEvE,KAAKkW,OAAOrT,YAER+V,EAAcC,KAAKC,UAAU9Y,KAAKkW,OAAOrT,KAC7CqO,EAAI,QAAgBhC,mBAAmB0J,GACvC,MAAO9c,IAGPuC,EAAQ0a,gBAAe7H,EAAO7S,EAAQ0a,mBAEpCC,EAAQC,QACZd,IAAcxX,GAAkBtC,EAAQ6a,WAAalZ,KAAKmZ,aAGtDtL,UAAI,MACMmL,IADN,SAES,IAFT,QAGQC,QAAQ5a,EAAQ+a,WAHxB,MAIMJ,IAJN,UAKU3c,KAAKC,SAGnB8P,EAAS,IAAIsB,GAAa1N,KAAMkR,EAAKpQ,GAASoQ,EAAMrD,GAEpD3I,EAAW8P,EAAW3W,EAAQ6G,UAChC,kBAAM7G,EAAQ6G,SAASkH,OAErBiN,EAAiBrE,EAAW3W,EAAQgb,gBACtC,kBAAMhb,EAAQgb,eAAejN,OAE3BgH,EAAgB/U,EAAQ+U,sBAE1B+E,IAAcxX,GAAkBtC,EAAQ6a,WAAalZ,KAAKmZ,mBACvDxD,QAAQnQ,KAAK,CAChB2S,UAAAA,EACAD,SAAU7Z,EAAQ6Z,SAClBtK,OAAQsD,EACRhS,KAAMb,EACNwP,KAAAA,EACA3I,SAAAA,EACAkO,cAAAA,IAIA+E,IAAcxX,GAAkBtC,EAAQ6Z,WAAahX,SAClD2U,WAAazJ,GAGhBpM,KAAKmZ,aAAgB9a,EAAQ6a,YAAc7a,EAAQib,WAChDC,kBACA,KAECC,EAAetB,MADDxH,GAAOkB,eAAeV,GAM1CR,GAAOyC,WAAWqG,GAHA,kBAAMrN,GAAajH,EAAUgM,EAAK7L,UACpC,kBAAM8G,GAAaiH,EAAelC,EAAK7L,UAKzD/F,YAAW,kBAAM6M,GAAakN,EAAgBnI,EAAK7L,aAMrDoU,MAAA,SAAMtF,EAAM9V,OAGNqb,EACAxU,EACAmU,EACAjG,EAKAmF,EACAa,EAXAT,EAAY,GACZN,EAAY,GAKZtK,EAAUhO,UAAUA,UAAUlD,OAAS,GACvCsb,EAAYzX,EACZ4Y,GAAQ,EACRJ,GAAY,SAIZlE,EAAWjH,GAAU7I,EAAW6I,EAC3BsJ,EAAStJ,KACZiH,EAAWjH,EAAQ7I,UAAWA,EAAW6I,EAAQ7I,SAC5C8P,EAAWjH,EAAQ4L,aAAYzU,EAAW6I,EAAQ4L,WACvD3E,EAAWjH,EAAQ6L,gBACrBP,EAAiBtL,EAAQ6L,cACvB5E,EAAWjH,EAAQ8L,WAAUzG,EAAgBrF,EAAQ8L,SAEpDvP,EAAYyD,EAAQoK,aAAYA,EAAYpK,EAAQoK,WACpD7N,EAAYyD,EAAQwK,WAAUA,EAAUxK,EAAQwK,SAChDjO,EAAYyD,EAAQqL,WAAUA,EAAUrL,EAAQqL,SAEjDpZ,KAAKkW,OAAOxT,KACT4H,EAAYyD,EAAQuL,SAAQA,EAAQL,QAAQlL,EAAQuL,QAEpDhP,EAAYyD,EAAQmL,WAEdI,IAAOJ,GAAY,GAD5BA,EAAYD,QAAQlL,EAAQmL,YAG9BA,GAAY,GAKXlZ,KAAKkW,OAAOvT,KAAuB3C,KAAKyV,eAC3CkD,QAAiBA,EAAcjI,GAAOqC,wBACjC0C,cAAe,GAItBkD,QACKA,EACAjI,GAAOiC,eAAe3S,KAAKkW,OAAOrS,MAInCyG,EAAY6J,IAASA,IAASjP,EAChCmT,EAAYxX,EAGLyJ,EAAYjM,IAAYA,IAAY6G,GACvC8F,GAASmJ,KACXkE,EAAYlE,GAEVkD,EAASlD,KACPA,EAAKA,MAAQA,EAAKA,OAAStT,IAC7BwX,EAAYxX,QAGTsW,YAAYwB,EAAWxE,WAKzBgD,YAAYwB,EAAWta,GAC5Bga,EAAYlE,GAGdwE,EAAU7X,GAAUgJ,KAGhBuO,IAAcxX,IAChB8X,EAAUvH,IAAMuH,EAAUvH,KAAOpR,KAAK8Z,aACtCnB,EAAUxH,MAAQwH,EAAUxH,OAASnR,KAAK+Z,eAC1CpB,EAAUzG,OAASyG,EAAUzG,QAAUlS,KAAKga,gBAC5CrB,EAAUsB,IAAMtB,EAAUsB,KAAOja,KAAKka,SACtCvB,EAAU/X,GAAgBiL,KAC1B8M,EAAUwB,WAAY7P,EAAYqO,EAAUwB,YAExCxB,EAAUwB,UAETpM,GAAYA,EAAQoK,YAAWA,EAAYxX,GAE5CX,KAAKkW,OAAO9R,KAED,MADbsV,EAAOf,EAAUe,MAAQ1Z,KAAKoa,gBACF,MAATV,IACjBf,EAAUe,KAAOA,SAKlB1B,MAAM,CACTE,SAAUhX,EACV4T,YAAa9U,KAAK8U,YAClBC,YAAa/U,KAAK+U,YAClBsD,UAAAA,EACAM,UAAAA,EACAR,UAAAA,EACAjT,SAAAA,EACAmU,eAAAA,EACAjG,cAAAA,EACAkG,MAAAA,EACAJ,UAAAA,EACAE,QAAAA,EACAb,QAAAA,SAGG8B,YAEEra,QAGT8N,OAAA,SAAOwM,EAAQjc,EAAS0P,SAClB7I,EACAmU,EACAjG,EACAkG,GAAQ,EACRJ,GAAY,EAEZlE,EAAWjH,GAAU7I,EAAW6I,EAC3BsJ,EAAStJ,KACZiH,EAAWjH,EAAQ7I,UAAWA,EAAW6I,EAAQ7I,SAC5C8P,EAAWjH,EAAQ4L,aAAYzU,EAAW6I,EAAQ4L,WACvD3E,EAAWjH,EAAQ6L,gBACrBP,EAAiBtL,EAAQ6L,cACvB5E,EAAWjH,EAAQ8L,WAAUzG,EAAgBrF,EAAQ8L,SAErD7Z,KAAKkW,OAAOxT,KACT4H,EAAYyD,EAAQuL,SAAQA,EAAQL,QAAQlL,EAAQuL,QAEpDhP,EAAYyD,EAAQmL,WAEdI,IAAOJ,GAAY,GAD5BA,EAAYD,QAAQlL,EAAQmL,YAG9BA,GAAY,aAIVP,UACH7X,GAASwZ,IACVC,QAASva,KAAKkW,OAAO/S,KAAeuN,GAAO0B,sBAGvCoG,EAAU,QAEgBjU,mBAAyB,eAA7CkU,OAAUC,OAChBra,GAAWA,EAAQoa,KACrBD,EAAQE,GAASra,EAAQoa,WAIzBzY,KAAKkW,OAAO5R,MACdkU,EAAQrJ,OAASnP,KAAK0W,aAAe1W,KAAKmP,aAGvCgI,YAAYwB,EAAWH,QAEvBrB,YACHwB,EACArN,GAAiBjN,EAAS4C,EAAwBsD,UAG/CyT,MAAM,CACTE,SAAU/W,EACV4X,cAAeJ,EACfzT,SAAAA,EACAmU,eAAAA,EACAjG,cAAAA,EACAkG,MAAAA,EACAJ,UAAAA,IAGKlZ,QAGTiO,aAAA,SAAaqM,SACPE,GAAe,iBAEV3E,qBAAY/Q,MAAOwV,SACrBzE,WAAa,WAGfF,QAAU3V,KAAK2V,QAAQ/N,KAAI,SAAC6S,gBAC3BA,EAAK7M,OAAO9M,KAAYwZ,GAC1BE,GAAe,QAGVC,GACH5M,WACK4M,EAAK5M,aADN,WAEgB,IAFhB,OAGY,IAHZ,SAKA4M,EAAKtC,YAAcxX,EACf8Z,EAAK5M,KAAL,UACCxR,KAAKC,MAAQme,EAAK5M,KAAL,WACd4M,EAAK5M,KAAL,WARJ,SASc,SAKf4M,KAGLD,QACGjB,iBAOTmB,UAAA,SAAUrC,EAA4BvN,EAAUzM,OAC1Csc,kBADItC,IAAAA,EAAY,oBAEdtN,EAAWC,GAASF,GAAYzM,GAAW,GAAKyM,GAAY,GAE5D8P,EAAS,SAAC3P,EAAI4P,EAAIC,EAAO5U,GAC7BlB,GAAiBiG,EAAI,UAAU,SAACnP,GAC9Bif,EAAKC,iBAAiBlf,EAAGmP,EAAI4P,EAAI9P,WAKnC4P,EADE5P,EAASmJ,SACLnJ,EAASmJ,SAETrJ,GAAWC,EAAUC,KAIlB4P,EAAI9d,OAAS,MACjB,IAAIgJ,KAAK8U,EACZC,EAAOD,EAAI9U,GAAIwS,MAKrB2C,iBAAA,SAAiBlf,EAAGmP,EAAIoN,EAAWha,YAAAA,IAAAA,EAAU,QACvC4c,GAAgB,MAEfhQ,EAAGkC,aAAanM,GAAyB,KACtCkY,EAAYD,QAAQjZ,KAAKkW,OAAOxT,KAEhCwY,EAAaxK,GAAOoD,cAAc7I,EAAI5M,MAExC2W,EAAW3W,EAAQkZ,UAAW,KAC1B4D,EAAa9c,EAAQkZ,SAAS2D,IAAe,GAE/CC,QACG5D,SAAS4D,OAIZvB,EAAe5E,EAAW3W,EAAQub,cACpCvb,EAAQub,kBACRnf,EACEkf,EAAY3E,EAAW3W,EAAQ6G,UACjC,kBAAM7G,EAAQ6G,SAASgW,SACvBzgB,EACEof,EAAU7E,EAAW3W,EAAQwb,SAAWxb,EAAQwb,aAAUpf,KAE3D4D,EAAQ+c,UAAUnQ,EAAGoQ,aAAara,EAAwB,GAE3D3C,EAAQ+c,UAAYlC,OACjBO,MAAMpB,EAAW6C,EAAY,CAChCtB,aAAAA,EACAC,QAAAA,EACAF,UAAAA,EACAT,UAAAA,QAEG,CACLpd,EAAE2L,iBACF3L,EAAEwf,sBAKIC,EAAQjc,YAAW,WAClB2b,GACHhQ,EAAGuQ,WAEJxb,KAAKkW,OAAO3S,UAEVkW,MAAMpB,EAAW6C,EAAY,CAChCtB,aAAAA,EACAD,qBACE1Z,aAAasb,GAET5B,GAAWA,IAEVsB,GAAehQ,EAAGuQ,SAEvBP,GAAgB,GAElBpB,QAAAA,SAgBR4B,WAAA,SAAWpD,EAA4BvN,EAAUoQ,EAAY7c,uBAAlDga,IAAAA,EAAY,yBAAsCha,IAAAA,EAAU,QACjEsc,EAAM,GAEJC,EAAS,SAAC3P,EAAI4P,EAAIC,EAAO5U,GAC7BlB,GAAiBiG,EAAItJ,GAAa,SAAC7F,GACjC4f,EAAKC,kBAAkB7f,EAAGmP,EAAI4P,EAAIC,EAAO5U,UAQ3CyU,EADEtc,EAAQ6V,SACJ7V,EAAQ6V,SAERrJ,GAAWC,EAAUzM,OAItB,IAAIwH,EAAI,EAAGA,EAAI8U,EAAI9d,OAAQgJ,IAC9B+U,EAAOD,EAAI9U,GAAIwS,EAAW6C,EAAY7c,MAK5Csd,kBAAA,SAAkB7f,EAAGmP,EAAIoN,EAAW6C,EAAY7c,OAC1C4c,GAAgB,MAEfhQ,EAAGkC,aAAanM,GAAyB,KACtCkY,EAAYD,QAAQjZ,KAAKkW,OAAOxT,KAEhCkX,EAAe5E,EAAW3W,EAAQub,cACpCvb,EAAQub,kBACRnf,EACEkf,EAAY3E,EAAW3W,EAAQ6G,UACjC,kBAAM7G,EAAQ6G,SAASgW,SACvBzgB,EACEof,EAAU7E,EAAW3W,EAAQwb,SAAWxb,EAAQwb,aAAUpf,KAE3D4D,EAAQud,OAAO3Q,EAAGoQ,aAAara,EAAwB,GAExD3C,EAAQud,OAAS1C,OACdO,MAAMpB,EAAW6C,EAAY,CAChCtB,aAAAA,EACAC,QAAAA,EACAF,UAAAA,EACAT,UAAAA,QAEG,CACLpd,EAAE2L,qBAKI8T,EAAQjc,YAAW,WAClB2b,GACHhQ,EAAG4Q,UAEJ7b,KAAKkW,OAAOtT,UAEV6W,MAAMpB,EAAW6C,EAAY,CAChCtB,aAAAA,EACAD,qBACE1Z,aAAasb,GAET5B,GAAWA,IAEVsB,GAAehQ,EAAG4Q,QAEvBZ,GAAgB,GAElBpB,QAAAA,SAMRQ,UAAA,sBACM/P,EAAYtK,KAAK8b,qBACdA,aAAeC,aAAY,WAC9BC,EAAKC,SACJjc,KAAKkW,OAAOhS,SAInBgY,SAAA,WACO5R,EAAYtK,KAAK8b,gBACpBK,cAAcnc,KAAK8b,qBACZ9b,KAAK8b,iBAOhBG,KAAA,WACMjc,KAAKkW,OAAOjS,KAAajE,KAAKqV,KAAOrV,KAAKkW,OAAOvS,UAK9CuY,eAGD5f,EAAMD,KAAKC,aACbA,EAAM0D,KAAKsV,cAAgBtV,KAAKkW,OAAOxS,WACpC2R,KAAO/Y,EAAM0D,KAAKsV,eAGlBtV,QAMTwF,KAAA,SAAKN,eACE8S,MAAM,CACTE,SxB/3B2B,WwBg4B3BpD,YAAa9U,KAAK8U,YAClBC,YAAa/U,KAAK+U,YAClB7P,SAAAA,SAGGqU,cAEEvZ,QAGToc,iBAAA,SAAiBnV,EAAUD,OACnB1K,EAAMD,KAAKC,eAER+f,EAAe5B,oBACdzT,QACD5F,OACAC,eACC/E,EAAMme,EAAK5M,KAAL,MAAwB4M,EAAK7M,OAAO2K,gBAC5C,SACkB,KAKjBvR,IAAa5F,GACZ6F,IAAa5F,GACd2F,IAAa3F,GACZ4F,IAAa7F,EAER,WAGT,UACoB9E,UAGjBgF,eACH,MAEImZ,EAAK5M,KAAL,OAAyBvR,EAAMme,EAAK5M,KAAL,UAA4B,MAF/D,SAII4M,EAAK5M,KAAL,UAA4BvR,EAAMme,EAAK5M,KAAL,aAJtC,MAKgBvR,SAGbkF,eACH,MAEIiZ,EAAK5M,KAAL,OAAyBvR,EAAMme,EAAK5M,KAAL,MAAwB,oBAIpD,SAIR8H,QAAU3V,KAAK2V,QAAQ/N,KAAI,SAAC6S,UAC3BA,EAAKtC,YAAcxX,EAAuB8Z,QAGzCA,GACH5M,WACK4M,EAAK5M,KACLwO,EAAe5B,SAKpBza,KAAK6V,kBACFA,iBACA7V,KAAK6V,YACRhI,WACK7N,KAAK6V,WAAWhI,KAChBwO,EAAerc,KAAK6V,mBAM/ByG,kBAAA,SAAkBnE,cACVoE,EAAY,eAEb5G,QAAQ9O,SAAQ,SAAC4T,SAElBA,EAAK5M,KAAL,UACC4M,EAAK5M,KAAL,WACD4M,EAAK5M,KAAL,SAEA0O,EAAU/W,WACLiV,EAAKvb,MACRyZ,gBACM8B,EAAKvb,KAAKyZ,WAAa,WAC1B7X,GAASgJ,OACVqQ,WAAW,YAMnBoC,EAAU1V,SAAQ,SAAC4T,UAAS+B,EAAKxE,MAAMyC,WAElC9E,QAAU3V,KAAK2V,QAAQ8G,QAAO,SAAChC,UAC9BA,EAAK5M,KAAL,UAEA4M,EAAK5M,KAAL,OACF2O,EAAK5G,YAAYpQ,KAAK,CACpB2S,UAAWsC,EAAKtC,UAChBD,SAAUuC,EAAKvC,SACftK,aACK6M,EAAK7M,QAEVC,WACK4M,EAAK5M,MAEV6O,gBAAiBjC,EAAKvV,SACtBkO,cAAeqH,EAAKrH,iBAIpBqH,EAAK5M,KAAL,YAEA4M,EAAKtC,YAAcxX,GAAkBwX,IAAcxX,YAOpDgV,QAAU3V,KAAK2V,QAAQ/N,KAAI,SAAC6S,sBAC5BA,GACH5M,WACK4M,EAAK5M,aADN,OAEY,IAFZ,MAGW,WAIbsK,IAAcxX,GAAkBX,KAAK6V,iBAClCD,YAAYpQ,KAAK,CACpB2S,UAAWxX,EACXuX,SAAUhX,EACV0M,aACK5N,KAAK6V,WAAWjI,QAErBC,WACK7N,KAAK6V,WAAWhI,QAKlB0O,EAAU1f,OAAS,KAG5B8f,kBAAA,sBACQC,EAAa5c,KAAKkW,OAAO5R,aAEtBuY,EAAoBjP,GAC+BA,EAAjD9M,GAAiD8M,EAApCuB,OAAoCvB,EAA5B2M,QAA4B3M,EAAnBvI,UAAUyX,uIAASlP,GAAjD9M,8CAEFnG,OAAO2O,KAAKwT,GAAMjgB,OAAS,MAG9BkgB,EAAQ/c,KAAK4V,YAAY9N,QAAO,SAACiV,EAAOtC,UAC5CsC,EAAMtC,EAAK7M,OAAO9M,IAAW,GAEtBic,IACN,SAEEnH,YAAY/O,SAAQ,SAAC4T,GACxBsC,EAAMtC,EAAK7M,OAAO9M,IAAS0E,KAAKiV,WAG7B7E,YAAc,OAEboH,EAASriB,OAAO2O,KAAKyT,GACxBnV,KAAI,SAAC9C,OACEmY,EAAQF,EAAMjY,GAEdoM,EAAO,CACXgH,cAAUzd,EACVmT,OAAQ,GACR+L,UAAW,GACXE,QAAS,WAGXoD,EAAMpW,SAAQ,SAAC4T,SACRvJ,EAAKgH,WACJuC,EAAKvC,WAAahX,GAAkBuZ,EAAK5M,KAAL,KACtCqD,EAAKgH,SAAW/W,EAEhB+P,EAAKgH,SAAWuC,EAAKvC,UAIzBhH,EAAKtD,OAAO2M,QAAUE,EAAK7M,OAAO2M,QAClCrJ,EAAKtD,OAAOvI,MAAQoV,EAAK7M,OAAOvI,MAChC6L,EAAKtD,OAAO9M,GAAU2Z,EAAK7M,OAAO9M,GAE9B8b,IACF1L,EAAKtD,OAAOuB,OAAS+N,EAAKxG,aAAewG,EAAK/N,SAI7CsL,EAAKtC,YAAcxX,GAClB8Z,EAAK7M,OAAO9M,eAAYoc,EAAKrH,mBAALsH,EAAiBrY,MAC3C2V,EAAK5M,KAAL,SAA2B,IAE3BqD,EAAKtD,OAAOwP,SAAW3C,EAAK5M,KAAL,UAGrB4M,EAAK5M,KAAKjN,KACZsQ,EAAKtD,0BACH9P,KAAKuf,MAAgC,IAA1B5C,EAAK5M,KAAKjN,IAA0B,KAG9C6Z,EAAK5M,KAAL,OACHqD,EAAKtD,aAAcsD,EAAKtD,OAAW6M,EAAK7M,QAEpCoH,EAAWyF,EAAKiC,kBAClBxL,EAAKyI,UAAUnU,KAAKiV,EAAKiC,iBAGvB1H,EAAWyF,EAAKrH,gBAClBlC,EAAK2I,QAAQrU,KAAKiV,EAAKrH,mBAKxBlC,EAAKtD,OAAO2M,UACfrJ,EAAKtD,OAAO2M,QACV2C,EAAKhH,OAAO/S,KAAeuN,GAAO0B,oBAG/BlB,KAERuL,QAAO,SAAChC,UAASoC,EAAoBpC,EAAK7M,cAEzCoP,EAAOngB,OAAS,KACdmD,KAAKkW,OAAOxT,IAAc,KACtB4a,EAAW,CAAC,IAEJN,EAAOpV,KAAI,gBAAGsQ,IAAAA,SAAUtK,IAAAA,cACpCiL,KAAKC,UAAU,CAAEZ,SAAAA,EAAUtK,OAAAA,OAIvB/G,SAAQ,SAAC0W,GAEX,IAAIC,KAAK,IAAIF,EAASA,EAASzgB,OAAS,GAAK0gB,IAASE,MAAQ,MAE9DH,EAAS9X,KAAK,IAEhB8X,EAASA,EAASzgB,OAAS,IAAS0gB,UAGtCD,EAASzW,SAAQ,SAAC6W,EAAS9gB,OACnB+gB,EAAW,IAAIC,SAErBD,EAASE,OAAO,UAAWH,EAAQ/gB,MAAM,GAAI,IAE7CsY,UAAUC,WAAWvZ,KACnBsZ,UACAiI,EAAKvF,YAAY,QACjBgG,MAIJX,EAAOnW,SAAQ,SAAC4T,GACdA,EAAKd,UAAU9S,SAAQ,SAAC3B,UACtBiH,GAAajH,EAAUuV,EAAK7M,OAAOvI,kBAIvC2X,EAAOnW,SAAQ,SAAC4T,OAORjB,EANW0D,EAAKvF,YAAY8C,EAAKvC,cAEnBxH,GAAOkB,mBACzB0G,OAAO,GACJmC,EAAK7M,SAaV8C,GAAOyC,WAAWqG,GATA,kBAChBiB,EAAKd,UAAU9S,SAAQ,SAAC3B,UACtBiH,GAAajH,EAAUuV,EAAK7M,OAAOvI,aAEvB,kBACdoV,EAAKZ,QAAQhT,SAAQ,SAAC3B,UACpBiH,GAAajH,EAAUuV,EAAK7M,OAAOvI,mBAS/CkU,YAAA,SAAYpB,YAAAA,IAAAA,EAAYzX,QACjB4b,kBAAkBnE,QAClBwE,uBAMPmB,MAAA,eAIAC,OAAA,SAAOzI,YAAAA,IAAAA,EAAgBjZ,KAAKC,YACrBgZ,cAAgBA,OAChBD,KAAO,KAYd2B,MAAA,SAAMlb,EAAGwZ,QACFyI,OAAOzI,MAGdtI,QAAA,SAAQlR,MACDkE,KAAKkW,OxBzqCoB,uBwB2qCxBgD,EAAYD,QAAQjZ,KAAKkW,OAAOxT,KAIhCsb,EAAcnR,GAFD/Q,EAAX6K,OAEsCjC,OAE1CsZ,EAAa,KACTrZ,EAAUqZ,EAAYrZ,QAAQgI,cAE9BuO,EAAa,YACLlb,KAAK8Z,0BACH9Z,KAAK+Z,eACnBkE,KACED,EAAYE,WAAaF,EAAYxjB,OAASwjB,EAAYG,YAC5DhN,MAAO6M,EAAYG,YACnBhiB,KAAkB,MAAZwI,EAAkB,OAASqZ,EAAY7hB,KAC7CiiB,QAASzZ,EACT0Z,UAAWL,EAAYM,UACvBlN,IAAK4M,EAAYxM,SAGfxR,KAAKkW,OAAO9R,IAAoB,KAC5BsV,EAAO1Z,KAAKoa,cAEL,KAATV,GAAwB,MAATA,IACjBwB,EAAW,aAAexB,QAIzBD,MAAM,eAAgByB,EAAY,CACrChC,UAAAA,SAKNpC,OAAA,SAAOhb,EAAGgX,OACFoG,EAAYD,QAAQjZ,KAAKkW,OAAOxT,KAChC6b,EAAgBve,KAAKkW,OAAO9S,IAO5Bob,EALyB,IAAI/d,aAC3B8d,EAAchN,KAAK,cACzB,KAGgDzU,KAAKgW,EAAK2L,UAExDze,KAAKkW,OAAO5S,KAA0Bkb,IACxC/Y,GAAK7D,EAAgBkR,EAAKtB,MAEtBsB,EAAKnM,SAAW5F,GAAgB2P,GAAOwC,UAAUpX,KACnDgX,EAAKuI,aAAara,EAAwB,GAErCkY,IACHpd,EAAE2L,iBACF3L,EAAEwf,kBAEFhc,YAAW,WACTwT,EAAK+I,UACJ7b,KAAKkW,OAAO7S,QAanBrD,KAAKkW,OAAOnS,MACXya,GACD9N,GAAO2B,eAAeS,EAAKb,YAE3BxM,GAAKxD,GAAgB6Q,EAAKtB,MAEtBsB,EAAKnM,SAAW5F,GAAgB2P,GAAOwC,UAAUpX,KACnDgX,EAAKuI,aAAara,EAAwB,GAErCkY,IACHpd,EAAE2L,iBACF3L,EAAEwf,kBAEFhc,YAAW,WACTwT,EAAK+I,UACJ7b,KAAKkW,OAAOpS,WAMvB+S,WAAA,SAAWzF,OACH8H,EAAYD,QAAQjZ,KAAKkW,OAAOxT,UAEjC+W,MACH7X,EACA,CACEwP,IAAAA,GAEF,CAAE8H,UAAAA,OAINjC,SAAA,SAAS7F,OACD8H,EAAYD,QAAQjZ,KAAKkW,OAAOxT,UAEjC+W,MACHxX,GACA,CACEmP,IAAAA,GAEF,CAAE8H,UAAAA,OAINwF,SAAA,WACO1e,KAAKmZ,mBACHA,aAAc,OACdiD,iBACH9a,EACAE,QAEG+X,YAAY5Y,OAIrB6M,kBAAA,SAAkB1R,OACRkL,EAAuBlL,EAAvBkL,SAAUC,EAAanL,EAAbmL,gBAEVD,QACD5F,OACEgb,iBAAiBnV,EAAUD,QAC3BuS,mBACAwE,oBAGF1c,OAKAC,OACE8a,iBAAiBnV,EAAUD,QAC3BuS,yBAGF/X,OACEkd,eAKXpR,SAAA,SAASxR,QACFiiB,aAEC/R,EAAcH,KAEN7L,KAAK2V,QAAQ8G,QACzB,SAAChC,UAASA,EAAKtC,YAAcxX,KAGzBkG,SAAQ,SAAC8X,GACbA,EAAG9Q,KAAKjN,GAAgB9C,KAAKG,IAC3B,EACAH,KAAKC,IAAIiO,EAAa2S,EAAG9Q,KAAKjN,IAAiB,UASrDsW,aAAA,SAAapK,OACL8R,EAAM5e,KAAKkW,OAAOhT,OAEnB0b,WAIDC,EAFEC,EAAU9T,GAAS4T,GAAO,CAACA,GAAOG,GAAQH,GAAOA,EAAM,GAIpD/Y,EAAI,EAAGA,EAAIiZ,EAAQjiB,OAAQgJ,QACS,IAAvCiH,EAAKmF,SAAS1L,QAAQuY,EAAQjZ,IAAY,CAC5CgZ,GAAc,WAKdA,EAAa,KACTG,EAAYhf,KAAKif,SAASnS,GAE5BkS,IACFlS,EAAK0E,KAAOwN,QASlBE,MAAA,WACExO,GAAOG,WAAWsO,WAChBnf,KAAKkW,OAAOlT,IACZhD,KAAKkW,OAAOjT,IACZjD,KAAKkW,OAAOpT,UAETqM,OAAS,UACT6G,kBAOPiJ,SAAA,SAAS7N,OACHnG,EACAmU,EACAX,EACAY,KAEArU,GAASoG,KACXnG,EAAK9C,SAASkL,cAAc,MACzB7B,KAAOJ,EACVgO,EAAQnU,EAAGqU,OAAS,IAAM,KACjBlO,GAAOA,EAAII,OACpBvG,EAAKmG,GAGHnG,SACFmU,EAAQnU,EAAGqU,OAAS,IAAM,IAC1Bb,EACExT,EAAGwT,UAAsC,MAA1BxT,EAAGwT,SAAS1hB,OAAO,GAC9BkO,EAAGwT,aACCxT,EAAGwT,SAEbY,EACEpU,EAAGgH,UACFhH,EAAGsU,MAAoB,KAAZtU,EAAGsU,MAA2B,OAAZtU,EAAGsU,MAA6B,MAAZtU,EAAGsU,SAC7CtU,EAAGsU,KACP,IAEItU,EAAGyM,cAAa2H,EAAOZ,EAAWxT,EAAGqU,OAASF,EAA9CnU,cAAwEjL,KAAKmP,OAASlE,EAAGyO,QAOvG8F,WAAA,SAAWpO,OACHE,EAAQ,IAAI7Q,sCAA8C,MAC5Dgf,EAAOrO,KAEPA,GAAOA,EAAII,OACbiO,EAAOrO,EAAII,MAGTiO,SACKA,EAAKxiB,QAAQqU,EAAO,OAI/BwI,WAAA,kBACM9Z,KAAKkW,OAAOtS,IACP8M,GAAOE,SAAS,eAEfF,GAAOE,SAAS,YAAcF,GAAOE,SAAS,aAG1DwJ,YAAA,kBACS1J,GAAOE,SAAS,WAGzBmJ,aAAA,kBAC2D,IAAlD5R,SAASuX,qBAAqB,SAAS7iB,OAC1C,GACAsL,SAASuX,qBAAqB,SAAS,GAAGC,aAGhD3F,cAAA,kBACStJ,GAAOE,SAAS,eAGzBsJ,OAAA,kBACSxJ,GAAOE,SAAS,WAQzB6F,SAAA,SAASjF,YAAAA,IAAAA,EAAOd,GAAOE,SAAS,aACxBgP,EAAUpO,EAAK5E,MAAMpM,MAEvBof,GAAWA,EAAQ,UACdA,EAAQ,MAInBxH,gBAAA,eAEQyH,EAAI,CACRtF,QAASva,KAAKkW,OAAO/S,KAAeuN,GAAO0B,mBAC3CrN,SAAU/E,KAAKsF,aACfuI,KAAM6C,GAAOG,WAAW2G,QAAQ,YAAc,GAC9CsI,OAAWzV,OAAOyV,OAAOC,UAAS1V,OAAOyV,OAAOE,OAChDC,SACE5V,OAAO4K,UAAUiL,iBAAmB7V,OAAO4K,UAAUgL,UAAY,GACnEE,IAAKngB,KAAKkW,OxBv+CO,OwBw+CjBkK,QAASjY,SAASkY,iBAGfrgB,KAAKkW,OAAO/S,MACf0c,EAAES,MAAQ,YAEN5P,GAAO0B,qBAAuB1B,GAAOsB,cACvC6N,EAAES,OAAS,qBAKXtgB,KAAKkW,OAAO5R,MACdub,EAAE1Q,OAASnP,KAAK0W,aAAe1W,KAAKmP,QAIlCnP,KAAKkW,OxBn+CS,QwBo+ChB2J,EAAEU,GAAKvgB,KAAKkW,OxBp+CI,OwBu+CX2J,KAOTW,QAAA,eAGO,IAAI1b,UAFJoX,WAEUlc,KAAKuF,IACdvF,KAAKuF,IAAInK,eAAe0J,IAC1BD,GAAcC,EAAI9E,KAAKsF,sBAGtBC,IAAM,MAGN+E,EAAYD,OAAOrK,KAAKsF,0BAElB+E,OAAOrK,KAAKsF,cACnB,MAAOxJ,GACPuO,OAAOrK,KAAKsF,mBAAgB7K,SC3lDpC4P,OAAOoW,cAAgB5L,GACvBxK,OAAOqW,iBAAmBhQ,GAAOyC,WjBkE/BnO,GAAiBmD,SAAUxG,EAAaqL,IACxChI,GAAiBmD,SRPY,YQOeiF,IAC5CpI,GAAiBmD,SAAUnG,GAAiBqL,IAC5CrI,GAAiBqF,OAAQhI,GAAciL,IAEvCqT,GAAc3b,iBAAiB1C,GAAmBkL,IiBnE/ClD,EAAYD,OAAOuW,WACtBlQ,GAAOmE,QAAUA,GACjBxK,OAAOuW,QAAQlQ,OAASA,GAEpBsE,EAAW3K,OAAOwW,gBACpBxW,OAAOwW,eACPxW,OAAOwW,aAAe,OAK1B,IAAIC,GAASzW,OAAO+L,OAAS/L,OAAOgM,GACpC,IAAK/L,EAAYwW,QACV,IAAI3M,MAAQ2M,MACXA,GAAO1lB,eAAe+Y,IAAO,KAC3BpP,GAAW,IAAI8P,GAAQV,IAC3BpP,GAAS+Q,OAILxL,EAAYD,OAAO0W,iBACrB1W,OAAO0W,cAAgBhc"}